import se from"./MetadataAddButton.41902bb4.js";import ne from"./DroppableWrapper.e14af8ec.js";import le from"./ViewDatasetSelector.d6ec789c.js";import{_ as ie}from"./MetadataButton.vue.350ca6ce.js";import re from"./BaseContentHeader.0262d7f9.js";import{f as ce,r as _,H as T,v as d,o as v,b as S,e as l,t as h,l as o,w as i,u as a,n as de,g as me,ax as y,c as V,aw as ue,J as F,k as pe,M as fe,aK as ve,m as E,s as D,x as _e}from"./entry.102678be.js";import{_ as be}from"./ViewFilter.vue.d756c6e1.js";import{_ as we}from"./BaseContentFooter.vue.20fdc5e7.js";import{u as ge}from"./dimension_store.1aca34b5.js";import{u as xe}from"./useChartsSettings.971a22bb.js";const he={class:"label-title"},ye={class:"flex flex-col container"},ke={class:"label-title"},Ce={class:"pt-4 flex justify-between items-center"},Se=l("span",{class:"label-title"},"Permitir entrada de dados",-1),Ve={class:"pt-4 flex justify-between items-center"},Fe=l("span",{class:"label-title"},[E("Totais "),l("b",{class:"font-bold"},"linhas")],-1),$e={class:"pt-4 flex justify-between items-center"},Me=l("span",{class:"label-title"},[E("Totais "),l("b",{class:"font-bold"},"colunas")],-1),Te={key:0,class:"flex flex-auto flex-wrap"},De={class:"label-title"},Ee={class:"pt-4 flex justify-between items-center w-full"},Ae={class:"label-title"},Ue=l("div",{class:"h-px bg-grey-200 my-0 -mx-4 w-auto"},null,-1),Re=ce({__name:"ViewMeasureForm",props:{tableType:{type:String,default:"dimension"},viewTitle:{type:String,default:"Dados"}},emits:["block-changed","trigger-update-view"],setup(A,{emit:u}){const U=A,p=xe(),f=_(),b=_("1"),k=T({get(){var t;return(t=n.value)==null?void 0:t.axisX},set(t){n.value&&(n.value.axisX=t)}}),n=_(),r=_(!1),w=_(!1),N=ge(),B=T(()=>N.dimensions.map(t=>({value:t.id,label:t.name}))),I=()=>{w.value=!0};function X(){w.value=!1}const H=t=>{b.value="1",t||(n.value=void 0)};let C=-1;const K=(t,e)=>{r.value=!0,n.value=t,C=e};function L(){u("block-changed"),r.value=!1}function O(t){var c;const e={showAll:!1,axisX:void 0,name:(c=t.name)!=null?c:t.metricName,chips:[{aggregator:"SUM",metricId:t.id}]};p.setViewMeasureForm(e),u("trigger-update-view"),f.value=!1}const j=t=>{w.value=!1;const e=JSON.parse(t.dataTransfer.getData("value")).data;if("metricName"in e){const c={showAll:!1,axisX:void 0,name:e.metricName,chips:[{aggregator:"SUM",metricId:e.id}]};p.setViewMeasureForm(c),u("trigger-update-view")}else if("dimensionAttributeType"in e)if(e.dimensionAttributeType==="Number"){const c={showAll:!1,axisX:void 0,name:e.name,chips:[{aggregator:"SUM",attributeId:e.id}]};p.setViewMeasureForm(c),u("trigger-update-view")}else D("warning",`Dado tipo ${e.dimensionAttributeType} s\xF3 pode ser adicionado como m\xE9trica`);else D("warning","Esse tipo de dado n\xE3o pode ser adicionado como m\xE9trica")};function P(t){p.setFilterChip(t,C)}function R(t){p.removeViewMeasureForm(t),u("trigger-update-view"),setTimeout(()=>{r.value=!1},0)}return(t,e)=>{const c=se,W=ne,z=le,$=d("a-popover"),G=ie,J=re,Z=d("a-input"),g=d("a-form-item"),x=d("a-switch"),M=d("a-tab-pane"),q=_e,Q=d("a-select"),Y=be,ee=d("a-tabs"),te=we,oe=d("a-form");return v(),S("div",null,[l("p",he,h(U.viewTitle),1),l("div",ye,[o(W,de(me({onDragOver:I,onDragLeave:X,onDrop:j})),{default:i(()=>[o(c,{hover:a(w),onClick:e[0]||(e[0]=s=>f.value=!0)},null,8,["hover"])]),_:1},16),o($,{visible:a(f),"onUpdate:visible":e[3]||(e[3]=s=>y(f)?f.value=s:null),"overlay-class-name":"w-[400px]",placement:"bottomLeft",trigger:"click","arrow-point-at-center":"","destroy-popup-on-hide":""},{content:i(()=>[o(z,{chip:0,title:"Adicionar em dados",onTriggerUpdateView:e[1]||(e[1]=s=>u("trigger-update-view")),onCancel:e[2]||(e[2]=s=>f.value=!1),onSubmit:O})]),_:1},8,["visible"])]),o($,{visible:a(r),"onUpdate:visible":e[11]||(e[11]=s=>y(r)?r.value=s:null),"overlay-class-name":"w-[320px] shadow-sm view-popover",trigger:"click",placement:"bottomRight","arrow-point-at-center":"","destroy-popup-on-hide":"",onVisibleChange:H},{title:i(()=>[o(J,{"content-class":"pb-4",title:t.$t("SHEET.VIEW.edit_data"),onCancel:e[4]||(e[4]=s=>r.value=!1)},null,8,["title"])]),content:i(()=>[a(n)?(v(),V(oe,{key:0,model:a(n),autocomplete:"off"},{default:i(()=>[o(ee,{activeKey:a(b),"onUpdate:activeKey":e[9]||(e[9]=s=>y(b)?b.value=s:null),class:"view-tabs",centered:""},{default:i(()=>[o(M,{key:"1","force-render":"",tab:"Geral"},{default:i(()=>[o(g,{class:"mb-0 w-full","has-feedback":"",name:"name"},{default:i(()=>[l("p",ke,h(t.$t("GLOBAL.name")),1),o(Z,{value:a(n).name,"onUpdate:value":e[5]||(e[5]=s=>a(n).name=s),class:"mt-1.5 rounded-md h-[40px] shadow-xs"},null,8,["value"])]),_:1}),o(g,{class:"mb-2 w-full","has-feedback":"",name:"formula-avaible"},{default:i(()=>[l("div",Ce,[Se,o(x,{checked:a(n).enableDataEntry,"onUpdate:checked":e[6]||(e[6]=s=>a(n).enableDataEntry=s)},null,8,["checked"])]),l("div",Ve,[Fe,o(x,{disabled:""})]),l("div",$e,[Me,o(x,{disabled:""})])]),_:1})]),_:1}),o(M,{key:"2","force-render":"",tab:"Avan\xE7ado"},{default:i(()=>{var s;return[(s=a(n).chips)!=null&&s.length?(v(),S("div",Te,[o(g,{class:"mb-0 w-full","has-feedback":"",name:"formula"},{default:i(()=>[l("p",De,h(t.$t("SHEET.column")),1),o(Q,{value:a(k),"onUpdate:value":e[7]||(e[7]=m=>y(k)?k.value=m:null),class:"mitra-selector",options:a(B),"allow-clear":""},{suffixIcon:i(()=>[o(q,{class:"ant-select-suffix",type:"mdi",path:a(ue)},null,8,["path"])]),_:1},8,["value","options"])]),_:1}),l("div",Ee,[l("span",Ae,h(t.$t("SHEET.VIEW.show_all")),1),o(x,{checked:a(n).showAll,"onUpdate:checked":e[8]||(e[8]=m=>a(n).showAll=m),disabled:!a(n).axisX},null,8,["checked","disabled"])]),o(g,{class:"my-4 w-full"},{default:i(()=>[a(r)?(v(),V(Y,{key:0,"inset-list":"",index:a(C),onSubmit:P},null,8,["index"])):F("",!0)]),_:1})])):F("",!0)]}),_:1})]),_:1},8,["activeKey"]),Ue,o(te,{"container-class":"pt-4","confirm-text":t.$t("BUTTONS.save"),divider:!1,onConfirm:L,onCancel:e[10]||(e[10]=s=>r.value=!1)},null,8,["confirm-text"])]),_:1},8,["model"])):F("",!0)]),default:i(()=>[(v(!0),S(pe,null,fe(a(p).viewForm.viewMeasureForm,(s,m)=>(v(),V(G,{key:`metadata-${m}`,icon:a(ve),text:s.name,onClick:ae=>K(s,m),onClose:ae=>R(m)},null,8,["icon","text","onClick","onClose"]))),128))]),_:1},8,["visible"])])}}});export{Re as _};
