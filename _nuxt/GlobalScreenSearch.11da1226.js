import{f as _e,r as f,ae as xe,al as T,j as ge,a3 as we,H as I,v as F,o as r,b as h,u as d,c as O,w as u,l as p,aE as Se,e as a,t as i,J as x,k as X,M as Q,C as ye,dT as ke,ar as Z,m as ee,ax as Ce,i as m,aX as L,x as be,y as $e,z as Te,a as Oe}from"./entry.102678be.js";import Ee from"./PrefixWidgetsGlobalSearch.c07251fa.js";import{u as Ne}from"./dataset_store.f318df7c.js";import{u as Ae}from"./dimension_store.1aca34b5.js";import{u as De}from"./legacy_store.afec42ea.js";import{u as Ie}from"./metadata_store.49c5a48c.js";import{u as Pe}from"./useURLPaths.92126496.js";import{c as Re,b as Me,a as Ve}from"./useGoToScreen.2d5a4740.js";import{u as Je}from"./index.d52a6416.js";import"./HeaderBar.vue.02da9777.js";import"./simple_grid_purple.8fc55868.js";import"./phone_violet.fde2a48f.js";import"./layout_violet.70afa0aa.js";import"./useLegacyService.c9b3bbf8.js";import"./useHeadSettings.f1985dcc.js";import"./composables.aec528df.js";import"./index.3105222b.js";const Be=S=>($e("data-v-b51e7852"),S=S(),Te(),S),Ge={class:"w-[376px] global-search"},Fe={class:"flex justify-between"},Le={style:{"font-weight":"400","font-size":"14px"},class:"text-[#667085] text-sm font-normal mt-[5px]"},We=Be(()=>a("div",{style:{"font-weight":"400","font-size":"14px"},class:"text-[#667085] text-sm font-normal mt-[5px]"}," Ctrl K ",-1)),ze={class:"text-[#667085] text-sm font-medium"},Ue={class:"flex items-center overflow-hidden pr-auto"},je={class:"px-2 text-grey-700 text-sm font-medium truncate"},He={class:"px-2 text-grey-400 text-xs font-normal truncate"},Ke={class:"flex items-center overflow-hidden pr-auto"},Ye={class:"px-2 text-grey-700 text-sm font-medium truncate"},qe={class:"px-2 text-grey-400 text-xs font-normal truncate"},Xe={class:"flex items-center overflow-hidden pr-auto"},Qe={class:"px-2 text-grey-700 text-sm font-medium truncate"},Ze={class:"px-2 text-grey-400 text-xs font-normal truncate"},et={class:"text-[#667085] text-sm font-medium"},tt={key:0,class:"flex items-center overflow-hidden m-[10px]"},st={class:"flex items-center overflow-hidden pr-auto"},at={class:"px-2 text-grey-700 text-sm font-medium truncate"},nt={key:0,class:"mr-2"},ot={key:0,class:"bg-success-100 rounded-full w-[68px] h-[18px] text-xs font-normal text-success-500 flex items-center justify-center"},it={key:1,class:"bg-grey-100 rounded-full w-[94px] h-[18px] text-grey-400 text-xs font-normal flex items-center justify-center"},lt=["onClick"],rt={style:{display:"none"}},ct={key:1,class:"text-violet-600 text-xs font-normal"},dt=["onClick"],ut={style:{display:"none"}},mt=_e({__name:"GlobalScreenSearch",props:{searchValue:null,userAccess:null},setup(S,{expose:te}){const P=S,R=f(1),y=f(""),W=Ne(),z=Ae(),M=xe(),E=De(),se=Ie(),N=f(),V=f(!0),{workbookList:U}=T(M),{dimensions:ae}=T(z),{datasets:j}=T(W),{modulesScreenList:ne}=T(E),{merge:k}=T(ge()),J=f(),H=f(0),K=f(),g=f();B(),we(k,()=>{B()});const C=I(()=>k.value?(P.userAccess!=="BUSINESS"&&q.value.push(Y.value),q.value):ie.value),Y=I(()=>({id:"Nativas",name:m().$translate("NATIVE.natives"),children:[{name:m().$translate("NATIVE.cubes"),comand:"cube",id:-1},{name:m().$translate("NATIVE.dimensions"),comand:"dimension",id:-2},{name:m().$translate("NATIVE.connections"),comand:"data-reader",id:-3},{name:m().$translate("NATIVE.actions"),comand:"action",id:-5},{name:m().$translate("NATIVE.connectors"),comand:"connector",id:-8},{name:"Playground",comand:"playground-profiles",id:-13},{name:m().$translate("NATIVE.details_modal"),comand:"detail-builder",id:-16},{name:m().$translate("NATIVE.forms"),comand:"form-builder",id:-17}]})),w=f();function oe(){if(w.value=[],P.userAccess!=="BUSINESS"){w.value=ae.value.filter(t=>!(t.id>1&&t.id<7));let e;j.value&&(e=j.value.map(t=>({...t,id:t.id+"dataset"}))),w.value.push(...e)}return w.value}const ie=I(()=>(oe(),w.value.length?[{id:"Planilhas",name:m().$translate("PROJECT.spreadsheets"),children:U.value.map(e=>({...e,id:e.workbookId}))},{id:"Data",name:m().$translate("GLOBAL.data"),children:w.value}]:[{id:"Planilhas",name:m().$translate("PROJECT.spreadsheets"),children:U.value.map(e=>({...e,id:e.workbookId}))}]));function le(e){return!!e.includes("dataset")}const q=I(()=>[...ne.value.map(e=>({id:e.id,name:e.name,show:!1,hasInactivated:e.inactivatedScreens.length,children:[...e.activatedScreens.map(t=>({id:t.id,name:t.name,moduleId:e.id,activated:!0,isMobile:t.isMobile})),...e.inactivatedScreens.map(t=>({id:t.id,name:t.name,moduleId:e.id,activated:!1,isMobile:t.isMobile}))]}))]),re=(e,t)=>{if(t.value===1)return!0;if(t.value)return t.value.toLowerCase().includes(e.toLowerCase())};function ce(){R.value+=1}function de(e){y.value=e}function B(){if(me(),K.value="",k.value)E.fetchAll();else{const{baseId:e}=Pe();z.fetchDimensions(),W.fetchDatasets(),!M.workbookList.length&&e&&M.fetchWorkbooks(e)}}function b(e,t,l=!1){if(k.value){if(!l){if(t.key.includes("Nativas")){const o="-";e={id:`-${t.key.split(o)[1]}`,name:"Nativas"}}t.id&&E.setSelectedModule(t),E.setSelectedScreen(Number(e.id))}Re(Number(e.id),e.moduleId,{newTab:l})}else if(e.workbookId)Me(e.workbookId,{newTab:l});else{typeof e.id=="string"&&(e.id=Number(e.id.replace("dataset","")));const o=e;se.addOnMetadataList(o),Ve(`?open${o.isDimension?"Dimension":"Dataset"}=${o.id}`,{newTab:l})}A()}function A(){V.value=!1,setTimeout(()=>{V.value=!0,y.value=""},0)}function ue(e,t){const l="-",o=e.split(l),v=o[1],_=e.charAt(0)===l?o[1]:o[0],$=t.key.split(l)[1];if(["Planilhas","Data"].includes($)){const s=C.value.find(c=>c.id===$),n=s==null?void 0:s.children.find(c=>c.id===parseInt(_));g.value=n,b(g.value,t)}else{const s=C.value.find(c=>c.id===parseInt($));if(s===void 0){const c=C.value.find(G=>G.id==="Nativas"),D=c==null?void 0:c.children.find(G=>G.id===parseInt(_)*-1);g.value=D,b(g.value,t);return}const n=s==null?void 0:s.children.find(c=>c.id===parseInt(_));g.value=n,b(g.value,t)}K.value=v,N.value=void 0}function me(){H.value=(window.innerHeight-52)*.95}function fe(){return C.value.reduce((t,l)=>t+l.children.length,0)}Je(document,"keydown",e=>{const t=(e.ctrlKey||e.metaKey)&&e.key==="k";t&&(e.preventDefault(),e.stopPropagation(),J.value.focus());const o=document.getElementsByClassName("ant-select-selection-search-input")[0].getAttribute("aria-expanded");t&&o==="true"&&(e.preventDefault(),e.stopPropagation(),J.value.blur())});function he(){L().switchDialog("newFolderModelController",!0),A()}function pe(){L().switchDialog("addScreenController",!0),A()}function ve(){L().switchDialog("newMobileModelController",!0),A()}return te({nativeScreens:Y}),(e,t)=>{const l=be,o=Ee,v=F("a-select-option"),_=F("a-select-opt-group"),$=F("a-select");return r(),h("div",Ge,[d(V)?(r(),O($,{key:0,ref_key:"selectRef",ref:J,value:d(N),"onUpdate:value":t[3]||(t[3]=s=>Ce(N)?N.value=s:null),"list-height":d(H),"dropdown-class-name":"global-search-dropdown",class:"w-[376px]","show-search":"","filter-option":re,"show-action":["focus"],"auto-focus":"",mode:"single","not-found-content":"Nenhum resultado encontrado",onFocus:B,onChange:ue,onSearch:de},{suffixIcon:u(()=>[p(l,{style:{width:"14px",height:"14px"},color:"#667085",path:d(Se),type:"mdi"},null,8,["path"])]),placeholder:u(()=>[a("div",Fe,[a("div",Le,i(e.$t("GLOBAL.search_2")),1),We])]),default:u(()=>[P.userAccess!=="BUSINESS"&&d(k)?(r(),O(_,{key:0},{label:u(()=>[a("div",ze,i(e.$t("PROJECT.quick_access")),1)]),default:u(()=>[p(v,{value:"Criar tela"},{default:u(()=>[a("div",{class:"flex items-center overflow-hidden m-[10px]",onClick:t[0]||(t[0]=s=>pe())},[a("div",Ue,[p(o,{class:"min-h-[40px] min-w-[40px]","search-item-id":"Create Screen",title:"Create Screen","option-item":null,"option-is-data-set":!1}),a("div",null,[a("div",je,i(e.$t("PROJECT.create_screen")),1),a("div",He,i(e.$t("PROJECT.create_new_blank_screen")),1)])])])]),_:1}),p(v,{value:"Criar mobile"},{default:u(()=>[a("div",{class:"flex items-center overflow-hidden m-[10px]",onClick:t[1]||(t[1]=s=>ve())},[a("div",Ke,[p(o,{class:"min-h-[40px] min-w-[40px]","search-item-id":"Create Mobile",title:"Create Mobile","option-item":null,"option-is-data-set":!1}),a("div",null,[a("div",Ye,i(e.$t("PROJECT.create_mobile_screen")),1),a("div",qe,i(e.$t("PROJECT.create_new_blank_mobile_screen")),1)])])])]),_:1}),p(v,{value:"Criar pasta"},{default:u(()=>[a("div",{class:"flex items-center overflow-hidden m-[10px]",onClick:t[2]||(t[2]=s=>he())},[a("div",Xe,[p(o,{class:"min-h-[40px] min-w-[40px]","search-item-id":"Create Folder",title:"Create Folder","option-item":null,"option-is-data-set":!1}),a("div",null,[a("div",Qe,i(e.$t("PROJECT.create_folder")),1),a("div",Ze,i(e.$t("PROJECT.create_new_folder")),1)])])])]),_:1})]),_:1})):x("",!0),(r(!0),h(X,null,Q(d(C),s=>(r(),O(_,{key:s.id},{label:u(()=>[a("div",et,i(s.name),1)]),default:u(()=>[(r(!0),h(X,null,Q(s.children,(n,c)=>(r(),O(v,{key:`${n.id}-${s.id}-${s.show}`,value:`${n.id}-${n.name}`,class:ye({filtered:!s.show&&n.activated===!1&&!d(y)}),onClick:D=>b(n,s)},{default:u(()=>[!s.show&&n.activated===!1&&!d(y)?x("",!0):(r(),h("div",tt,[a("div",st,[p(o,{class:"min-h-[40px] min-w-[40px]","search-item-id":`${s.id}`,title:n.name,"option-item":n,"option-is-data-set":le(String(n.id))},null,8,["search-item-id","title","option-item","option-is-data-set"]),a("div",at,i(n.name),1)]),n.activated!==void 0?(r(),h("div",nt,[n.activated?(r(),h("div",ot,i(e.$t("PROJECT.published")),1)):(r(),h("div",it,i(e.$t("PROJECT.unpublished")),1))])):x("",!0),a("div",{class:"flex items-center w-fit ml-auto mr-2",onClick:Z(D=>b(n,s,!0),["stop","prevent"])},[p(l,{color:"#8D95B3",path:d(ke),type:"mdi",size:"18px",class:"icon-new-tab"},null,8,["path"])],8,lt),a("div",rt,i(d(R)),1)])),c===s.children.length-1?(r(),h("div",ct,[(s==null?void 0:s.hasInactivated)&&!d(y)&&!s.show?(r(),h("div",{key:0,class:"px-[10px] bg-white",onClick:Z(D=>(s.show=!0,ce()),["stop"])},[ee(i(e.$t("PROJECT.show_unpublished"))+" ",1),a("div",ut,i(d(R)),1)],8,dt)):x("",!0)])):x("",!0)]),_:2},1032,["value","class","onClick"]))),128))]),_:2},1024))),128)),fe()>13?(r(),O(v,{key:1,style:{height:"0px","min-height":"0px","pointer-events":"none"},class:"ghost-item"},{default:u(()=>[ee("\xA0")]),_:1})):x("",!0)]),_:1},8,["value","list-height"])):x("",!0)])}}}),Nt=Oe(mt,[["__scopeId","data-v-b51e7852"]]);export{Nt as default};
