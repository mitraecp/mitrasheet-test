import{r as R,ac as H,aC as N,ad as P,f as M,dK as G,E as O,bP as X,H as Z,al as U,aY as W,ae as j,N as J,O as K,u as r,b as V,e as o,t as p,l as a,w as Q,ax as Y,I as q,J as L,x as ee,v as E,o as F,ah as te,dQ as oe,aD as k,dR as se,y as ne,z as ie,a as ae}from"./entry.102678be.js";import re from"./SheetToDBRegister_.bde00d7c.js";import ce from"./SheetToDBAxisX_.03e1d7f0.js";import le from"./SheetToDBCube_.757b9d67.js";import de from"./MitraButton.1bc6f00c.js";import{u as me}from"./dimension_store.1aca34b5.js";import{u as pe}from"./dataset_store.f318df7c.js";import"./ProjectView.vue.c9650a78.js";import"./MetadataAddButton.41902bb4.js";import"./DroppableWrapper.e14af8ec.js";import"./SheetToDBAddRegister_.be23964f.js";import"./AddDimensionAutocomplete.4607c47e.js";import"./AddAttributesOfDimensionAutocomplete.0057a0b5.js";import"./useDataTypeIcons.d26d6eae.js";import"./MButton.vue.eb72e6c7.js";/* empty css                    */import"./useChartsSettings.971a22bb.js";import"./SheetToDBAddCube_.f1fa7175.js";import"./AddCubeAutocomplete.6aa2d88e.js";import"./MetadataButton.vue.350ca6ce.js";import"./useLegacyService.c9b3bbf8.js";/* empty css                         *//* empty css                             */import"./legacy_store.afec42ea.js";import"./useHeadSettings.f1985dcc.js";import"./composables.aec528df.js";import"./HeaderBar.vue.02da9777.js";import"./members_store.a95d955a.js";import"./metadata_store.49c5a48c.js";/* empty css                                    *//* empty css                           */import"./MitraIconButton.142ef623.js";/* empty css                         *//* empty css                            *//* empty css                             */import"./regexp.6086e722.js";/* empty css                        *//* empty css                        */const ue="sheetdb";function _e(){const c=R(!0);return{executeSheetToDB:async(_,i)=>{c.value=!0;const{data:l,error:h}=await H(`${ue}`,{body:N(_),method:"POST",params:i,serviceName:P.FREESHEET});return c.value=!1,{viewFormSheet:l.value,error:h.value}}}}const he=c=>(ne("data-v-3dda3266"),c=c(),ie(),c),ve={class:"flex flex-col sidebar-right sidebar-right-dynamization min-w-[260px] max-w-[260px] noselect"},xe={class:"flex justify-between items-center p-4 h-[56px] light-border-b"},fe={class:"flex items-center"},ge={class:"text-base font-medium text-[#1B2139]"},Se={class:"h-full py-4 overflow-auto"},ye={class:"px-1"},De={class:"px-2"},Be={class:"text-[#313854] text-[14px] font-medium"},Te={key:0,class:"text-[red] text-[10px] mt-1"},be=he(()=>o("div",{class:"px-2 py-2"},null,-1)),we={class:"px-1"},Ve={class:"flex items-center px-1"},Ee={class:"text-[#313854] font-semibold text-[14px]"},Fe={class:"pt-2 px-2"},ke={class:"px-1"},Re={class:"flex items-center px-1"},Ae={class:"text-[#313854] font-semibold text-[14px]"},Ie={class:"py-2 px-2"},Ce={class:"mx-3 my-3"},$e=M({__name:"SheetToDBMenu_",emits:["update-view","block-changed","close-view","update-range","show-all","view-filter","trigger-update-view","clear-borders-by-range","verify-range-is-valid","view-menu-change","set-header-and-content-of-range","update-workbook","set-dynamic-selection-by-range"],setup(c,{emit:n}){const{executeSheetToDB:_}=_e(),i=G();O(()=>{n("view-menu-change")}),X(()=>{n("view-menu-change")});const l=Z({get(){return i.sheetToDBForm.range},set(t){t&&i.setRange(t)}}),{preview:h}=U(W()),v=j();function A(){const t=v.getWorkbookDinamization(),e={workBookId:v.activeSheetRef.workbookId,workSheetId:v.activeSheetIndex,range:i.sheetToDBForm.range,sheetToDBDimensionForm:i.sheetToDBForm.sheetToDBDimensionForm,sheetToDBXAxisForm:i.sheetToDBForm.sheetToDBXAxisForm,sheetToDBMetricsForm:i.sheetToDBForm.sheetToDBMetricsForm,dynamizationFilterForm:{filterItems:t}};_({...e}).then(()=>{n("update-workbook"),i.resetSheetToDBForm()})}function I(t){const e=/([A-Z]+)([0-9]+):([A-Z]+)([0-9]+)/,d=/([A-Z]+)([0-9]+)/,x=e.test(t);return t.split(":").length===1?d.test(t):x?(()=>{const[,u,g,S,s]=t.match(e)||[],B=u.charCodeAt(0),T=S.charCodeAt(0),b=parseInt(g),w=parseInt(s);return B<=T&&b<=w&&B>=65&&T>=65&&b>=1&&w>=1})():!1}const m=R({isValid:!0});function y(){m.value.isValid=I(l.value),m.value.isValid&&n("set-dynamic-selection-by-range",l.value)}const C=me(),$=pe();function z(){n("clear-borders-by-range",i.sheetToDBForm.range),i.resetSheetToDBForm()}return C.fetchDimensions(),$.fetchDatasets(),(t,e)=>{const d=ee,x=E("a-input"),f=E("a-divider"),D=re,u=ce,g=le,S=de;return J((F(),V("aside",ve,[o("div",xe,[o("div",fe,[o("div",ge,p(t.$t("SHEET.dynamization_area")),1)]),a(d,{class:"cursor-pointer",color:"grey",type:"mdi",size:"16",path:r(te),onClick:e[0]||(e[0]=s=>z())},null,8,["path"])]),o("div",Se,[o("div",ye,[o("div",De,[o("div",Be,p(t.$t("SHEET.RANGE.area_range")),1),a(x,{value:r(l),"onUpdate:value":e[2]||(e[2]=s=>Y(l)?l.value=s:null),class:"interval-btn rounded-md range-btn mt-2",placeholder:t.$t("SHEET.RANGE.select_range"),style:q({border:r(m).isValid?"1px solid #C7CBDD":"1px solid red"}),onChange:y,onFocus:y},{suffix:Q(()=>[a(d,{color:r(m).isValid?"#8D95B3":"red",type:"mdi",size:"16",path:r(oe),onClick:e[1]||(e[1]=s=>n("close-view"))},null,8,["color","path"])]),_:1},8,["value","placeholder","style"]),r(m).isValid?L("",!0):(F(),V("div",Te,p(t.$t("SHEET.RANGE.invalid_range")),1))]),be]),a(f,{class:"mx-0 my-0 mb-3"}),o("div",we,[o("div",Ve,[a(d,{class:"cursor-pointer mr-1",type:"mdi",size:"22",path:r(k)},null,8,["path"]),o("div",Ee,p(t.$t("SHEET.registrations")),1)]),o("div",Fe,[a(D,{onSetDynamicSelectionByRange:e[3]||(e[3]=s=>n("set-dynamic-selection-by-range",s)),onSetHeaderAndContentOfRange:e[4]||(e[4]=s=>n("set-header-and-content-of-range",s))})])]),a(u,{onSetDynamicSelectionByRange:e[5]||(e[5]=s=>n("set-dynamic-selection-by-range",s))}),o("div",ke,[o("div",Re,[a(d,{class:"cursor-pointer mr-1",type:"mdi",size:"22",path:r(k)},null,8,["path"]),o("div",Ae,p(t.$t("NATIVE.cubes")),1)]),o("div",Ie,[a(g,{onSetDynamicSelectionByRange:e[6]||(e[6]=s=>n("set-dynamic-selection-by-range",s))})])])]),a(f,{class:"mx-0 my-0"}),o("div",Ce,[a(S,{icon:r(se),text:t.$t("SHEET.systematize"),color:"var(--violet-600)",onClick:A},null,8,["icon","text"])])],512)),[[K,!r(h)]])}}}),St=ae($e,[["__scopeId","data-v-3dda3266"]]);export{St as default};
