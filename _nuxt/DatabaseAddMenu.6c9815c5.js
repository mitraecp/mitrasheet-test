import{f as P,r as v,i as C,H as w,v as D,aF as R,o as d,b as u,e as t,t as l,l as n,u as a,ah as q,ax as B,N as K,k as g,M as L,ap as T,C as Q,c as W,av as X,J as E,w as _,aE as Y,aG as Z,ay as ee,m as te,s as se,x as ae,a as oe}from"./entry.102678be.js";import{_ as ne}from"./MButton.vue.eb72e6c7.js";/* empty css                    */import{u as le}from"./metadata_store.49c5a48c.js";import{u as ie}from"./dataset_store.f318df7c.js";import{u as ce}from"./dimension_store.1aca34b5.js";/* empty css                         */import"./useLegacyService.c9b3bbf8.js";const de={class:"flex flex-col w-[368px] table-add-menu"},re={class:"flex justify-between items-center mb-[8px]"},ue={class:"title"},pe={class:"flex flex-col"},me={class:"flex flex-col mb-[12px]"},ve={class:"mb-[6px] text"},_e={class:"flex flex-col"},fe={class:"mb-[6px] text"},he={key:0,class:"flex flex-col mt-[12px]"},xe={class:"text"},ye={class:"container-list max-h-[200px]"},Ae={class:"truncate item dataset"},be={class:"flex items-center"},De={class:"ml-[8px] text-[16px] color-[#0E1428] truncate"},Be={class:"flex cursor-pointer chip mt-[12px]"},ke={class:"flex items-center justify-center"},Se={class:"ml-[4px]"},$e={class:"search-input"},Ce={class:"container"},we={class:"container-list"},ge=["title","onClick"],Le={class:"flex items-center"},Te={class:"flex items-center button-panel"},Ee=P({__name:"DatabaseAddMenu",props:{editor:{type:Boolean,default:!1}},emits:["submit","cancel"],setup(k,{emit:f}){const S=le(),N=ie(),h=ce();h.fetchDimensions();const c=v([]),p=v(""),m=v(void 0),r=v(""),O=[{label:C().$translate("DATABASE.register"),value:"dimension"},{label:C().$translate("DATABASE.cube"),value:"dataset"}],x=w(()=>m.value==="dataset"),z=w(()=>h.dimensions.filter(e=>e.name.toLowerCase().includes(p.value.toLowerCase())));function M(e){c.value.findIndex(i=>e.id===i.dimensionId)<0&&c.value.push({dimensionId:e.id,name:e.name,alias:e.name})}function I(){x.value?j():G()}function $(e){S.addOnMetadataList(e),f("submit",S.activeMetadataList.length-1)}function U(e){c.value.splice(e,1)}const j=async()=>{if(!c.value.length)se("TOAST.add_one_dimension_dataset");else try{await N.saveDataset({name:r.value.trim(),datasetDimensions:c.value}).then(e=>$(e))}catch{}},G=async()=>{try{await h.addDimension(r.value.trim()).then(e=>$(e))}catch{}};return(e,o)=>{const i=ae,V=D("a-select"),y=D("a-input"),F=D("a-popover"),H=ne,J=R("focus");return d(),u("div",de,[t("div",re,[t("div",ue,l(e.$t("DATABASE.new_table")),1),n(i,{class:"cursor-pointer",size:"15",color:"#8D95B3",type:"mdi",path:a(q),onClick:o[0]||(o[0]=s=>f("cancel"))},null,8,["path"])]),t("div",pe,[t("div",me,[t("div",ve,l(e.$t("DATABASE.type")),1),n(V,{value:a(m),"onUpdate:value":o[1]||(o[1]=s=>B(m)?m.value=s:null),options:O,class:"w-full",placeholder:e.$t("DATABASE.select")},null,8,["value","placeholder"])]),t("div",_e,[t("div",fe,l(e.$t("GLOBAL.name")),1),K(n(y,{ref:"input",value:a(r),"onUpdate:value":o[2]||(o[2]=s=>B(r)?r.value=s:null),placeholder:e.$t("GLOBAL.insert"),"data-cy":"input-name",class:"mr-4"},null,8,["value","placeholder"]),[[J]])])]),a(x)?(d(),u("div",he,[t("div",xe,l(e.$t("DATABASE.add_entries_to_cube"))+":",1),t("div",ye,[(d(!0),u(g,null,L(a(c),(s,A)=>(d(),u("div",{key:`choosed-dim-${s.dimensionId}`,class:"flex justify-between items-center my-2 pr-2 item-tile"},[t("div",Ae,[t("div",be,[n(i,{size:"20",color:"var(--grey-700)",type:"mdi",path:a(T)},null,8,["path"])]),t("div",De,l(s.name),1)]),t("div",{class:Q(["flex items-center",{"alias-wrapper":s.alias===s.name}])},[n(y,{value:s.alias,"onUpdate:value":b=>s.alias=b,disabled:k.editor,placeholder:e.$t("DATABASE.insert_nickname"),class:"rounded-md mx-2 w-[162px]"},null,8,["value","onUpdate:value","disabled","placeholder"]),k.editor?E("",!0):(d(),W(i,{key:0,size:"19",type:"mdi",color:"#5D6585",class:"cursor-pointer",path:a(X),onClick:b=>U(A)},null,8,["path","onClick"]))],2)]))),128))]),n(F,{trigger:"click",placement:"bottomLeft"},{content:_(()=>[t("div",$e,[n(y,{value:a(p),"onUpdate:value":o[3]||(o[3]=s=>B(p)?p.value=s:null),class:"h-[32px] w-[212px]",type:"text",placeholder:e.$t("DATABASE.find_record")},{prefix:_(()=>[n(i,{size:"16",color:"grey",type:"mdi",path:a(Y)},null,8,["path"])]),_:1},8,["value","placeholder"])]),t("div",Ce,[t("div",we,[(d(!0),u(g,null,L(a(z),(s,A)=>(d(),u("div",{key:A,class:"cursor-pointer select-none item",title:s.name,onClick:b=>M(s)},[t("div",Le,[n(i,{size:"20",color:"var(--grey-700)",type:"mdi",path:s!=null&&s.isDimension?a(T):a(Z)},null,8,["path"])]),t("span",null,l(s.name),1)],8,ge))),128))])])]),default:_(()=>[t("div",Be,[t("div",ke,[n(i,{size:"18",type:"mdi",color:"#7839EE",path:a(ee)},null,8,["path"])]),t("div",Se,l(e.$t("DATABASE.register")),1)])]),_:1})])):E("",!0),t("div",Te,[t("div",{class:"cancel cursor-pointer",mockup:!1,onClick:o[4]||(o[4]=s=>f("cancel"))},l(e.$t("BUTTONS.cancel")),1),n(H,{disabled:a(x)&&!a(c).length||!a(r),mockup:!1,style:{"background-color":"#7839ee",color:"#fff"},class:"!w-[61px] !h-[33px] flex justify-center items-center","data-cy":"btn-submit",onClick:I},{default:_(()=>[te(l(e.$t("GLOBAL.actions.create")),1)]),_:1},8,["disabled"])])])}}}),Ve=oe(Ee,[["__scopeId","data-v-9ca993d0"]]);export{Ve as default};
