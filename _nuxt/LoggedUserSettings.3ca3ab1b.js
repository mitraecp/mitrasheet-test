import{_ as Z}from"./UserInfo.vue.9a89b8e2.js";import{_ as ee}from"./HeaderBar.vue.02da9777.js";import te from"./LanguageSettings.087eeb24.js";import oe from"./SquaredBadge.8fadbfe8.js";import se from"./MitraButton.1bc6f00c.js";import{j as ne,q as y,R as h,f as ae,Y as ce,al as W,S as ie,r as v,E as re,H as D,v as E,aF as le,o as r,b as m,u as t,c as T,J as g,e as o,l as n,t as k,dh as pe,k as ue,M as de,C as me,w as x,N as _e,ax as B,at as fe,ay as N,ar as U,m as ve,i as A,eC as ge,eD as ke,aj as xe,a as ye}from"./entry.102678be.js";import{u as R}from"./useSpaceHelpers.ee842422.js";import{e as I}from"./useGoToScreen.2d5a4740.js";import"./CollaboratorAvatar.vue.dd08577c.js";import"./useMappedIcons.1032e4dc.js";/* empty css                         */import"./useURLPaths.92126496.js";import"./legacy_store.afec42ea.js";import"./useLegacyService.c9b3bbf8.js";import"./useHeadSettings.f1985dcc.js";import"./composables.aec528df.js";function he(){function w(){ne().loggout(),y(h.LOGIN)}return{logout:w}}const we={class:"flex-col items-center py-2.5"},be={class:"medium-border-y"},Se={class:"py-4 justify-between flex items-center"},Ce={class:"flex"},Le=["title"],$e={class:"text-sm text-grey-700 capitalize truncate"},Oe={class:"text-xs text-grey-400 truncate"},je={class:"pb-4"},Ge={key:0,class:"text-grey-700 text-xs"},We={class:"workspaces-wrapper"},De=["title"],Ee={class:"basis-1/4 flex justify-center items-center mt-4"},Te={class:"flex"},Be=ae({__name:"LoggedUserSettings",emits:["close-popup"],setup(w,{emit:_}){const l=ce(),{selectedWorkspace:c,workspaceList:b,readonlyWorkspace:P}=W(l),{loggedUser:S}=W(ie()),{logout:V}=he(),H=v(!0),i=v(""),p=v(!1);re(()=>{z()});const K=D(()=>[{label:A().$translate("GLOBAL.log_out"),icon:ge,onClick:V}]),M=D(()=>[{label:A().$translate("LOGGED.manage_account"),icon:ke,disabled:!0,onClick:F}]);function q(){_("close-popup"),y(`/w/${c.value.id}/settings`)}async function C(e){var u;const s=(u=e.projects)==null?void 0:u.at(-1);s?(await R().setupSpaceData(e,{project:s}),I(e.id,s.id),_("close-popup")):(await R().setupSpaceData({...e,projects:[]}),I(e.id,void 0,{withoutProject:!0}),_("close-popup"))}async function L(){if(!!i.value)try{const e=await l.createWorkspace(i.value);e&&e.projects.push(await l.saveProject({name:xe.global.t("GLOBAL.new_project"),workspaceId:e==null?void 0:e.id})),i.value="",p.value=!1,e&&C(e)}catch{}}async function z(){await l.fetchWorkspaces(),H.value=!1}function F(){y(`/${h.WORKSPACE_SHORTCUT}/${c.value.id}${h.USER_SETTINGS}`)}return(e,s)=>{var j,G;const u=Z,$=ee,J=te,O=oe,f=se,Y=E("a-input"),Q=E("a-dropdown"),X=le("focus");return r(),m("div",{onClick:s[3]||(s[3]=U(()=>{},["stop"]))},[t(S)?(r(),T(u,{key:0,user:t(S)},null,8,["user"])):g("",!0),o("div",we,[n($,{options:t(M)},null,8,["options"]),n(J,{class:"pt-4"})]),o("div",be,[o("div",Se,[o("div",Ce,[n(O,{class:"!mr-2",content:{color:"red",background:"rgb(122, 66, 199)",label:(G=(j=t(c).name)==null?void 0:j.slice(0,2))!=null?G:"W"}},null,8,["content"]),o("div",{title:t(c).name,class:"flex flex-col truncate max-w-[128px]"},[o("span",$e,k(t(c).name),1),o("span",Oe,k(e.$t("LOGGED.current_workspace")),1)],8,Le)]),t(P)?g("",!0):(r(),T(f,{key:0,"text-color":"var(--violet-600)",icon:t(pe),outlined:"",onClick:q},null,8,["icon"]))]),o("div",je,[t(b).length?(r(),m("span",Ge,k(e.$t("LOGGED.change_workspace")),1)):g("",!0),o("div",null,[o("div",We,[(r(!0),m(ue,null,de(t(b),(a,d)=>(r(),m("div",{key:`workspace-${d}`,class:me([{hidden:a.id===t(c).id},"basis-1/4 flex justify-center items-center mt-4"]),title:a.name},[n(O,{content:{color:"#000000",background:`rgb(${d+1*112}, ${d+1*66}, ${d+1*199})`,label:a.name.slice(0,2)},class:"content-badge",onClick:Ne=>C(a)},null,8,["content","onClick"])],10,De))),128)),o("div",Ee,[n(Q,{visible:t(p),"onUpdate:visible":s[2]||(s[2]=a=>B(p)?p.value=a:null),trigger:"click","destroy-popup-on-hide":"",placement:"topRight","overlay-class-name":"p-[18px] mitra-popover-wrapper medium-border-all"},{overlay:x(()=>[o("div",Te,[_e(n(Y,{value:t(i),"onUpdate:value":s[1]||(s[1]=a=>B(i)?i.value=a:null),type:"text",placeholder:e.$t("LOGGED.new_workspace"),onKeydown:fe(L,["enter"])},null,8,["value","placeholder","onKeydown"]),[[X]]),n(f,{class:"mx-2","text-color":"var(--violet-600)",icon:t(N),outlined:"",onClick:L},null,8,["icon"])])]),default:x(()=>[o("div",{onClick:s[0]||(s[0]=U(()=>{},["stop"]))},[n(f,{icon:t(N),"icon-class":"!text-violet-600",outlined:"","fit-to-content":"",color:"",class:"!min-w-[43.5px] !min-h-[43.5px] !bg-grey-100 !border-none"},{default:x(()=>[ve("Salvar")]),_:1},8,["icon"])])]),_:1},8,["visible"])])])])])]),n($,{class:"pt-2.5 pb-1",options:t(K)},null,8,["options"])])}}}),Ze=ye(Be,[["__scopeId","data-v-1f94fa55"]]);export{Ze as default};
