import{f as X,dK as Y,H as ee,r as m,v as D,o as p,b as y,e as o,t as a,l as d,u as s,ah as te,w as I,dQ as ne,ax as M,c as oe,J as se,aj as L,x as ae,a as ie}from"./entry.102678be.js";import re from"./AddDimensionAutocomplete.4607c47e.js";import le from"./AddAttributesOfDimensionAutocomplete.0057a0b5.js";import{_ as ce}from"./MButton.vue.eb72e6c7.js";/* empty css                    */import"./ProjectView.vue.c9650a78.js";import"./dimension_store.1aca34b5.js";import"./useLegacyService.c9b3bbf8.js";import"./useDataTypeIcons.d26d6eae.js";/* empty css                         *//* empty css                             */import"./MitraButton.1bc6f00c.js";import"./legacy_store.afec42ea.js";import"./useHeadSettings.f1985dcc.js";import"./composables.aec528df.js";import"./HeaderBar.vue.02da9777.js";import"./members_store.a95d955a.js";import"./dataset_store.f318df7c.js";import"./metadata_store.49c5a48c.js";/* empty css                                    *//* empty css                           */import"./useChartsSettings.971a22bb.js";import"./MitraIconButton.142ef623.js";/* empty css                         *//* empty css                            *//* empty css                             */import"./regexp.6086e722.js";/* empty css                        *//* empty css                        */const de={class:"flex flex-col w-[320px]"},ue={class:"flex justify-between items-center mb-[8px]"},me={class:"title"},pe={class:"flex flex-col"},_e={class:"py-1"},fe={class:"py-1 sub-title"},he={class:"flex flex-col"},ve={class:"py-1"},ge={class:"py-1 sub-title"},ye={class:"flex flex-col"},be={class:"py-1"},xe={class:"py-1 sub-title"},Ae={key:0,class:"text-left"},Te={key:1,class:"text-left"},Re={key:1,class:"flex flex-col justify-center items-center",style:{height:"130px"}},Ce={class:"text-center text-sm px-2 py-2"},Be={class:"text-[#d4d4d4]"},ke={class:"text-[#d4d4d4]"},Ee={key:0,class:"flex justify-between items-center mt-2"},De={class:"py-1 sub-title"},Ie={class:"py-1"},Se={class:"flex items-center mt-2"},$e=X({__name:"SheetToDBAddRegister_",props:{selectedDimensionByProp:{type:Object,required:!0,default:()=>({})},contentRange:{type:String,required:!0,default:""},attributesForm:{type:Object,required:!0,default:()=>({})}},emits:["cancel","set-header-and-content-of-range","set-dynamic-selection-by-range"],setup(W,{emit:_}){var w,F,P,V,H;const R=W,l=Y(),q=ee(()=>[{title:L.global.t("SHEET.column_2"),dataIndex:"coluna",key:"coluna",align:"center",width:"50%"},{title:L.global.t("SHEET.mapping"),dataIndex:"mapeamento",key:"mapeamento",align:"center",width:"50%"}]),b=m(!0),n=m(R.selectedDimensionByProp.value);function z(){}const i=m(R.contentRange),G=m(R.attributesForm.value),C=m({range:(w=l.sheetToDBForm)==null?void 0:w.range,name:(F=n==null?void 0:n.value)==null?void 0:F.name,dimensionId:((P=n==null?void 0:n.value)==null?void 0:P.id)||null,replaceWhenPrimaryAttributeContentMatches:!0,primarySheetToDBAttribute:{contentRange:"N/A",name:"Description",dimensionId:((V=n==null?void 0:n.value)==null?void 0:V.id)||null,dimensionAttributeId:null,dimensionAttributeType:"SingleLineText"},sheetToDBDimensionAttributesForm:((H=l.headersAndContentOfRange)==null?void 0:H.header.map(e=>{var t;return{contentRange:e.contentRange,name:"N/A",dimensionId:((t=n==null?void 0:n.value)==null?void 0:t.id)||null,dimensionAttributeId:null,dimensionAttributeType:"SingleLineText"}}))||[]}),B=m(null);function S(){$(i.value)&&(_("set-header-and-content-of-range",i.value),_("set-dynamic-selection-by-range",i.value))}function $(e=i.value){const t=/([A-Z]+)([0-9]+):([A-Z]+)([0-9]+)/,r=/([A-Z]+)([0-9]+)/,u=t.test(e);return e.split(":").length===1?r.test(e):u?(()=>{const[,A,k,E,T]=e.match(t)||[],f=A.charCodeAt(0),h=E.charCodeAt(0),v=parseInt(k),g=parseInt(T);return f<=h&&v<=g&&f>=65&&h>=65&&v>=1&&g>=1})():!1}function U(){if(!K())return;const t={range:i.value,name:n.value.name,dimensionId:n.value.id||null,replaceWhenPrimaryAttributeContentMatches:b.value||!0,primarySheetToDBAttribute:{...C.value.sheetToDBDimensionAttributesForm.find(r=>r.isPrimary)},sheetToDBDimensionAttributesForm:[...C.value.sheetToDBDimensionAttributesForm.slice(1)]};l.addSheetToDBDimensionForm(t),_("cancel")}function Z(e){var t;n.value=e,(t=B.value)==null||t.$el.focus()}function J(e){var r,u;G.value=e;const t=((r=l.headersAndContentOfRange)==null?void 0:r.header.findIndex(x=>x.contentRange===e.contentRange))||0;C.value.sheetToDBDimensionAttributesForm[t]={contentRange:e.contentRange||"",name:e.name,dimensionId:((u=n==null?void 0:n.value)==null?void 0:u.id)||null,dimensionAttributeId:e.id,dimensionAttributeType:e.dimensionAttributeType,isPrimary:t===0}}function K(){var e;return i.value?!0:((e=B.value)==null||e.$el.focus(),!1)}return(e,t)=>{var T,f,h,v,g,j;const r=ae,u=re,x=D("a-input"),O=le,A=D("a-table"),k=D("a-switch"),E=ce;return p(),y("div",de,[o("div",ue,[o("div",me,a(e.$t("SHEET.add_registration")),1),d(r,{class:"cursor-pointer",size:"15",color:"grey",type:"mdi",path:s(te),onClick:t[0]||(t[0]=c=>_("cancel"))},null,8,["path"])]),o("div",pe,[o("div",_e,[o("div",fe,a(e.$t("SHEET.dimension")),1),d(u,{"with-natives":"",onSelectedDimension:Z})])]),o("div",he,[o("div",ve,[o("div",ge,a(e.$t("SHEET.table_range")),1),d(x,{ref_key:"inputContentRange",ref:B,value:s(i),"onUpdate:value":t[1]||(t[1]=c=>M(i)?i.value=c:null),class:"interval-btn rounded-md range-btn mr-4",placeholder:e.$t("SHEET.RANGE.select_range"),style:{border:"1px solid #c7cbdd"},onChange:S,onFocus:S},{suffix:I(()=>[d(r,{color:"#8D95B3",type:"mdi",size:"16",path:s(ne)},null,8,["path"])]),_:1},8,["value","placeholder"])])]),o("div",ye,[o("div",be,[o("div",xe,a(e.$t("SHEET.columns_2")),1),$()&&((f=(T=s(l))==null?void 0:T.headersAndContentOfRange)==null?void 0:f.header)&&s(n)?(p(),oe(A,{key:0,"data-source":(h=s(l).headersAndContentOfRange)==null?void 0:h.header,columns:s(q),"show-size-changer":!1,pagination:!1,scroll:((v=s(l).headersAndContentOfRange)==null?void 0:v.header.length)>3?{y:200}:!1},{bodyCell:I(({column:c,record:N,index:Q})=>[c.dataIndex==="coluna"?(p(),y("div",Ae,a(N.name),1)):(p(),y("div",Te,[d(O,{"content-range":N.contentRange,index:Q,"dimension-to-filter":s(n),onSelectedDimensionAttributeView:J},null,8,["content-range","index","dimension-to-filter"])]))]),_:1},8,["data-source","columns","scroll"])):(p(),y("div",Re,[o("div",Ce,[o("p",Be,a(e.$t("SHEET.please_select_valid_range")),1),o("p",ke,a(e.$t("SHEET.view_columns")),1)])]))])]),((j=(g=s(l))==null?void 0:g.headersAndContentOfRange)==null?void 0:j.header)&&s(n)?(p(),y("div",Ee,[o("div",De,a(e.$t("SHEET.use_description_key")),1),o("div",Ie,[d(k,{checked:s(b),"onUpdate:checked":t[2]||(t[2]=c=>M(b)?b.value=c:null),class:"mr-auto",onClick:z},null,8,["checked"])])])):se("",!0),o("div",Se,[o("div",{class:"cancel cursor-pointer",mockup:!1,onClick:t[3]||(t[3]=c=>_("cancel"))},a(e.$t("BUTTONS.cancel")),1),d(E,{mockup:!1,style:{"background-color":"#7839ee",color:"#fff"},class:"!w-[80px] !h-[33px] flex justify-center items-center","data-cy":"btn-submit",onClick:U},{default:I(()=>[o("div",null,a(e.$t("GLOBAL.confirm")),1)]),_:1})])])}}}),lt=ie($e,[["__scopeId","data-v-f627faf0"]]);export{lt as default};
