import{f as V,j as $,r as u,H as x,s as C,v as I,o as m,b as p,l as f,w as j,u as d,aE as R,ax as U,e as S,k as g,M as z,C as O,t as q,x as G,a as H}from"./entry.102678be.js";import{a as T}from"./useLegacyService.c9b3bbf8.js";import{u as J}from"./members_store.a95d955a.js";/* empty css                        */import"./dimension_store.1aca34b5.js";const K={class:"container my-2 overflow-auto max-h-[350px]"},P=["data-cy","onClick"],Q={class:"text-sm text-grey-900 font-normal"},W=V({__name:"ContentSecurityCorpSelector",props:{referencedDimensionId:null,securityId:null,memberInternalId:null,content:null},emits:["update-content"],setup(k,{emit:b}){const a=k,{merge:w}=$(),v=T(),_=J(),h=u(!1),r=u(""),o=u([]),c=x(()=>o.value.filter(e=>e.name&&e.name.toLowerCase().includes(r.value.toLowerCase())).slice(0,1e3)),A=x(()=>a.content?Array.isArray(a.content)?a.content:[a.content]:[]);D();async function D(){h.value=!0;try{o.value=[],await L(),N()}catch{C("Falha ao carregar membros dessa dimens\xE3o!")}h.value=!1}async function L(){const{dimensionDataView:e}=await v.getDimensionContent(a.referencedDimensionId,{query:{limit:100,offSet:o.value.length}});o.value=[...o.value,...e.contents.map(t=>({id:t.internalId,name:t.dimensionContentAttributesView[0],picture:""}))]}function N(){for(let e=0;e<o.value.length;e++)a.content.some(n=>n.id===o.value[e].id)?o.value[e].isSelected=!0:o.value[e].isSelected=!1}function B(e){e.isSelected=!e.isSelected,M()}function M(){var t;const e=[];for(let n=0;n<c.value.length;n++)if(c.value[n].isSelected){const i={id:c.value[n].id,name:(t=c.value[n].name)!=null?t:""};e.push(i)}E(e)}async function E(e){const t=w?"id":"dimensionAttributeId",n={id:{id:_.collaboratorId,mergeDimensionAttributeType:"DIMENSION_MAIN"},dimensionId:_.collaboratorId,dimensionContentForms:[{internalId:a.memberInternalId,dimensionContentAttributeForms:[{[t]:a.securityId,value:e}]}]};try{const{error:i}=await v.putDimensionContent(n);i?C(i.message):b("update-content",e)}catch{}}return(e,t)=>{const n=G,i=I("a-input"),F=I("a-checkbox");return m(),p(g,null,[f(i,{value:d(r),"onUpdate:value":t[0]||(t[0]=s=>U(r)?r.value=s:null),class:"h-[32px] pb-2",type:"text",placeholder:e.$t("GLOBAL.search")},{prefix:j(()=>[f(n,{size:"16",color:"grey",type:"mdi",path:d(R)},null,8,["path"])]),_:1},8,["value","placeholder"]),S("div",K,[(m(!0),p(g,null,z(d(c),s=>{var y;return m(),p("div",{key:`${s.id}`,class:O(["cursor-pointer flex items-center justify-between py-2 px-2",{active:d(A).find(l=>l.id===s.id)}]),"data-cy":`option-${s.id}`,onClick:l=>B(s)},[S("div",Q,q((y=s.name)!=null?y:"unnamed record"),1),f(F,{ref_for:!0,ref:"checkboxRef",checked:s.isSelected,"onUpdate:checked":l=>s.isSelected=l,class:"flex justify-end"},null,8,["checked","onUpdate:checked"])],10,P)}),128))])],64)}}}),ne=H(W,[["__scopeId","data-v-55ef0ba8"]]);export{ne as default};
