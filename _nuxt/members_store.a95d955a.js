import{a as m}from"./useLegacyService.c9b3bbf8.js";import{u as a}from"./dimension_store.1aca34b5.js";import{aa as c,aB as d,s as r}from"./entry.102678be.js";const o=m(),b=c("MembersStore",{state:()=>({membersDimensionContent:{headers:[],contents:[],rowCount:-1},dimensions:[],tempDimensions:[],securityContentDimensions:{headers:[],contents:[],rowCount:-1},membersActive:[],securityCorpActive:[],collaboratorId:51,collaborator:[],openInvitations:[],isWorkspace:!1}),actions:{disposeMembersStore(){this.membersDimensionContent={headers:[],contents:[],rowCount:-1},this.membersActive=[],this.dimensions=[],this.tempDimensions=[],this.securityContentDimensions={headers:[],contents:[],rowCount:-1},this.securityCorpActive=[],this.collaborator=[],this.openInvitations=[],this.isWorkspace=!1},async fetchData(e){this.disposeMembersStore(),this.isWorkspace=e!=null?e:!1,await this.fetchDimensions(),this.collaboratorId=this.dimensions[this.collaboratorDimensionIndex].id,await this.fetchMembersData()},async fetchDimensions(){const e=a();await e.fetchDimensions(),this.setMembersDimensions(e.dimensions)},async fetchMembersData(){const{dimensionDataView:e}=await o.getDimensionContent(this.collaboratorId,{query:{limit:d.SIMPLE_ROW_LIMIT,offSet:0}});this.setMembersByDimensionContent(e),this.setActiveMembers(),this.setActiveSecurityCorp(),this.setSelectedDimensionsByActiveSecurityCorp(),this.setTempSecurityDimensions()},setSelectedDimensionsByActiveSecurityCorp(){for(let e=0;e<this.dimensions.length;e++){const t=this.securityCorpActive.some(n=>n.name===this.dimensions[e].name);this.setSelectedDimensionValue(e,t)}},setMembersByDimensionContent(e){this.membersDimensionContent=e},setMembersDimensions(e){this.dimensions=e},setSelectedDimensionValue(e,t){this.dimensions[e].isDimensionSelected=t},setTempSelectedDimension(e,t){this.tempDimensions[e].isDimensionSelected=t},setActiveMembers(){const e=this.statusIndex,t=this.nameIndex,n=this.accessTypeIndex,s=this.spaceIndex;for(const i of this.membersDimensionContent.contents)this.isWorkspace?(i.dimensionContentAttributesView[e]==="INVITE_ACCEPTED"||i.dimensionContentAttributesView[e]==="PENDING_INVITE"||i.dimensionContentAttributesView[e]===null)&&i.dimensionContentAttributesView[t]!=="Removido"&&i.dimensionContentAttributesView[s]==="WORKSPACE"&&(i.dimensionContentAttributesView[n]==="OWNER"&&(i.dimensionContentAttributesView[n]="Owner"),this.membersActive.push(i)):(i.dimensionContentAttributesView[e]==="INVITE_ACCEPTED"||i.dimensionContentAttributesView[e]==="PENDING_INVITE"||i.dimensionContentAttributesView[e]===null)&&i.dimensionContentAttributesView[t]!=="Removido"&&(i.dimensionContentAttributesView[n]==="OWNER"&&(i.dimensionContentAttributesView[n]="Owner"),this.membersActive.push(i))},setActiveSecurityCorp(){for(let e=0;e<this.membersDimensionContent.headers.length;e++)(this.membersDimensionContent.headers[e].dimensionAttributeType==="SecurityMultiLink"||this.membersDimensionContent.headers[e].dimensionAttributeType==="SecuritySingleLink")&&(this.membersDimensionContent.headers[e].isSelectMenuOpen=!1,this.securityCorpActive.push(this.membersDimensionContent.headers[e]))},securityCorpIndex(e){return this.membersDimensionContent.headers.findIndex(t=>t.name===e)},setTempSecurityDimensions(){this.tempDimensions=[];for(const e of this.dimensions){const t={attributeCount:e.attributeCount,dimensionAttributeViews:e.dimensionAttributeViews,id:e.id,isDimension:e.isDimension,isDimensionSelected:e.isDimensionSelected,isNative:e.isNative,name:e.name,primaryDimensionAttributeView:e.primaryDimensionAttributeView};this.tempDimensions.push(t)}},async deleteSecurityCorp(e,t){const{error:n}=await o.deleteContentAttribute(this.securityCorpActive[e].id);n?r("error","Delete security corp error"):(this.dimensions[t].isDimensionSelected=!1,this.securityCorpActive.splice(e,1),this.fetchData())},async addSecurityCorp(e,t){const n={dimensionAttributeType:"SecurityMultiLink",dimensionId:this.collaboratorId,name:e.name,referencedDimensionId:e.id},{value:s,error:i}=await o.postContentAttribute(n);i?r("error","Add security corp error"):(this.dimensions[t].isDimensionSelected=!0,this.securityCorpActive.push(s))},setActiveProjectMembers(e){this.collaborator=e},setActiveProjectOpenInvitations(e){this.openInvitations=e},collabIndexByEmail(e){return this.collaborator.findIndex(t=>t.email===e)},openInvitationsIndexByEmail(e){return this.openInvitations.findIndex(t=>t.email===e)},changeCollaboratorAccessType(e,t){this.collaborator&&(this.collaborator[e].accessType=t)},deleteMember(e){this.membersActive.splice(e,1)}},getters:{statusIndex(){return this.membersDimensionContent.headers.findIndex(e=>e.name==="Status")},nameIndex(){return this.membersDimensionContent.headers.findIndex(e=>e.name==="Nome")},pictureIndex(){return this.membersDimensionContent.headers.findIndex(e=>e.name==="Picture")},spaceIndex(){return this.membersDimensionContent.headers.findIndex(e=>e.name==="Space")},emailIndex(){return this.membersDimensionContent.headers.findIndex(e=>e.name==="Email")},accessTypeIndex(){return this.membersDimensionContent.headers.findIndex(e=>e.name==="Permiss\xF4es")},collaboratorDimensionIndex(){return this.dimensions.findIndex(e=>e.name==="Colaborador"||e.name==="Collaborator")}}});export{b as u};
