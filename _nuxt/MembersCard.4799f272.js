import we from"./MembersCardProjectHead.c5888078.js";import Se from"./MembersCardWorkspaceHead.ae74c38f.js";import{f as ge,Y as Ae,al as Y,H as q,r as _,i as ke,v as M,o as a,b as r,l as c,w as S,c as T,e as s,t as f,J as p,k as V,M as N,u as t,aR as Me,av as Q,aD as Te,C as Ve,aw as Ee,ay as De,ax as Z,T as B,s as G,S as Oe,aX as $e,x as Ne,y as Be,z as Pe,a as Re}from"./entry.102678be.js";import{_ as We}from"./CollaboratorAvatar.vue.dd08577c.js";import Ue from"./ContentSecurityCorpSelector.de0ab5aa.js";import Le from"./DeleteSecurityMenu.c4334075.js";import je from"./DeleteMemberPanel.1719ab11.js";import{u as Ge}from"./members_store.a95d955a.js";/* empty css                        */import"./SecurityCorpSelector.009eae15.js";import"./MButton.vue.eb72e6c7.js";/* empty css                    */import"./useLegacyService.c9b3bbf8.js";import"./dimension_store.1aca34b5.js";const ze=y=>(Be("data-v-8a60a358"),y=y(),Pe(),y),Ke={class:"flex bg-[white] z-10 items-center min-h-[44px] justify-between"},Fe={class:"ml-1 name-column px-5 text-grey-500 mr-auto"},He={key:0,class:"status-column"},Je={class:"permission-column text-grey-500"},Xe={key:1,class:"flex"},Ye=["onClick"],qe={class:"text-grey-500 items-center flex px-4 cursor-pointer"},Qe={class:"w-[16px] flex"},Ze={class:"px-2 items-center text-center flex"},et=["onClick"],tt={class:"px-2 text-grey-700 text-sm font-normal cursor-pointer"},nt={class:"w-[16px] flex items-center"},ot=ze(()=>s("div",{class:"delete-column flex justify-end pr-4"},null,-1)),st={class:"overflow-auto w-auto"},it={class:"flex items-center h-[64px] justify-between"},at={class:"name-column flex items-center px-2 mr-auto"},lt={class:"px-2"},rt={key:0,class:"text-grey-900 text-sm font-medium"},ct={class:"text-grey-500 text-sm font-normal"},ut={key:0,class:"status-column flex items-center"},dt={key:0,class:"rounded-xl bg-success-50 px-2 py-0.5"},pt={class:"text-xs text-success-700"},mt={class:"permission-column py-2"},vt={key:1,class:"flex"},_t=["onClick"],ft={class:"w-[20px] flex items-center"},yt={class:"flex items-center"},bt={class:"delete-column py-4 flex justify-end pr-4"},ht=ge({__name:"MembersCard",props:{isWorkspaceEdit:{type:Boolean}},setup(y){const i=Ge(),ee=Ae(),{projectOpened:te,openedSpaceId:E,openedWorkSpaceId:D}=Y(ee),{membersActive:g,securityCorpActive:A,nameIndex:z,pictureIndex:ne,emailIndex:P,statusIndex:R,accessTypeIndex:m,isWorkspace:v}=Y(i);function oe(e){U.value=e}const se=q(()=>U.value!==""?g.value.filter(e=>e.dimensionContentAttributesView[z.value].toLowerCase().includes(U.value.toLowerCase())):g.value),O=q(()=>te.value?"PROJECTS":"WORKSPACE");function K(){return g.value.length}const b=_([]),k=_(!1),C=_(!1),$=_([]),W=_(),F=_(),U=_("");ie();function ie(){for(let e=0;e<A.value.length;e++)b.value.push(!1);for(let e=0;e<g.value.length;e++)$.value.push(!1)}function H(){return g.value.some(n=>n.dimensionContentAttributesView[R.value]==="PENDING_INVITE")}function ae(e,n){$.value[e]=!0,A.value[n].isSelectMenuOpen=!0}function le(e,n){W.value=n,b.value[e]=!1,k.value=!0}const re=_([{value:"CREATOR",label:ke().$translate("METADATA.creator")},{value:"BUSINESS",label:"Business"}]);function L(e){return i.securityCorpIndex(e.name)}function ce(e){b.value[e]=!1}function ue(e,n){$.value[e]=!1,A.value[n].isSelectMenuOpen=!1}async function de(e,n){const d=n.value,x=i.collabIndexByEmail(e);if(x!==-1)i.changeCollaboratorAccessType(x,d),await B().updateSpaceCollaborator({collaboratorId:i.collaborator[x].collaboratorId,userId:i.collaborator[x].userId,accessType:d,spaceId:v.value?D.value:E.value,spaceType:v.value?"WORKSPACE":O.value});else{const I=i.openInvitationsIndexByEmail(e);I!==-1?(i.changeCollaboratorAccessType(I,d),await B().updateSpaceInvite({spaceId:v.value?D.value:E.value,inviteId:i.openInvitations[I].inviteId,spaceType:v.value?"WORKSPACE":O.value,accessType:d})):G("TOAST.members_not_found")}}function pe(e,n){F.value={email:e,memberIndex:n},C.value=!0}async function me(e){C.value=!1;const n=i.collabIndexByEmail(e.email);try{if(n!==-1)i.collaborator[n].accessType!=="OWNER"&&(await B().deleteSpaceCollaborator({collaboratorId:i.collaborator[n].collaboratorId,userId:i.collaborator[n].userId,accessType:i.collaborator[n].accessType,spaceId:v.value?D.value:E.value,spaceType:v.value?"WORKSPACE":O.value}),i.deleteMember(e.memberIndex),_e(i.collaborator[n].userId));else{const d=i.openInvitationsIndexByEmail(e.email);d!==-1?(await B().removeSpaceInvite({spaceId:v.value?D.value:E.value,inviteId:i.openInvitations[d].inviteId,spaceType:v.value?"WORKSPACE":O.value,accessType:i.openInvitations[d].accessType}),i.deleteMember(e.memberIndex)):G("TOAST.members_not_found")}}catch{G("TOAST.fail_remove_member")}}function ve(e,n,d){e[n]=d}function _e(e){var n;e===((n=Oe().loggedUser)==null?void 0:n.id)&&$e().switchDialog("invitationPanelController")}return(e,n)=>{const d=we,x=Se,I=M("a-divider"),w=Ne,J=M("a-popover"),fe=We,ye=M("a-select"),be=Ue,he=M("a-card"),Ce=Le,X=M("a-modal"),xe=je;return a(),r(V,null,[c(he,{class:"bg-white rounded-md flex flex-col overflow-hidden card-member"},{default:S(()=>[y.isWorkspaceEdit?(a(),T(x,{key:1,"members-lenght":K(),onApplyFilter:oe},null,8,["members-lenght"])):(a(),T(d,{key:0,"members-lenght":K()},null,8,["members-lenght"])),c(I,{class:"my-0"}),s("div",Ke,[s("div",Fe,f(e.$t("GLOBAL.name")),1),H()?(a(),r("div",He)):p("",!0),s("div",Je,f(e.$t("GLOBAL.permission")),1),y.isWorkspaceEdit?p("",!0):(a(),r("div",Xe,[(a(!0),r(V,null,N(t(A),(o,u)=>(a(),r("div",{key:u,class:"flex security-corp",onClick:l=>t(b)[u]=!0},[s("div",qe,[s("div",Qe,[c(w,{color:"#8D95B3",path:t(Me),type:"mdi"},null,8,["path"])]),s("div",Ze,f(o.name),1),t(b)[u]?(a(),T(J,{key:0,visible:t(b)[u],"onUpdate:visible":l=>t(b)[u]=l,"overlay-class-name":"px-4",trigger:"click",placement:"bottom","destroy-tooltip-on-hide":"",onVisibleChange:l=>ce(u)},{content:S(()=>[s("div",{class:"flex items-center",onClick:l=>le(u,o)},[c(w,{color:"#313854",path:t(Q),type:"mdi",size:"16px"},null,8,["path"]),s("div",tt,f(e.$t("GLOBAL.delete")),1)],8,et)]),_:2},1032,["visible","onUpdate:visible","onVisibleChange"])):p("",!0),s("div",nt,[c(w,{color:"#8D95B3",path:t(Te),type:"mdi"},null,8,["path"])])])],8,Ye))),128))])),ot]),c(I,{class:"my-0"}),s("div",st,[(a(!0),r(V,null,N(t(se),(o,u)=>(a(),r("div",{key:u,class:Ve(u%2===0?"bg-grey-50":"bg-white")},[s("div",it,[s("div",at,[c(fe,{src:`${o.dimensionContentAttributesView[t(ne)]}`,width:40,height:40},null,8,["src"]),s("div",lt,[o.dimensionContentAttributesView[t(R)]!=="PENDING_INVITE"?(a(),r("div",rt,f(o.dimensionContentAttributesView[t(z)]),1)):p("",!0),s("div",ct,f(o.dimensionContentAttributesView[t(P)]),1)])]),H()?(a(),r("div",ut,[o.dimensionContentAttributesView[t(R)]==="PENDING_INVITE"?(a(),r("div",dt,[s("span",pt,f(e.$t("MEMBERS.inivitation_sent")),1)])):p("",!0)])):p("",!0),s("div",mt,[c(ye,{value:o.dimensionContentAttributesView[t(m)],"onUpdate:value":l=>o.dimensionContentAttributesView[t(m)]=l,"label-in-value":"",options:t(re),class:"w-[142px]",read:"","show-arrow":`${o.dimensionContentAttributesView[t(m)]}`!="OWNER"||`${o.dimensionContentAttributesView[t(m)]}`!="Owner",disabled:`${o.dimensionContentAttributesView[t(m)]}`=="OWNER"||`${o.dimensionContentAttributesView[t(m)]}`=="Owner",onChange:l=>de(o.dimensionContentAttributesView[t(P)],o.dimensionContentAttributesView[t(m)])},{suffixIcon:S(()=>[c(w,{type:"mdi",path:t(Ee)},null,8,["path"])]),_:2},1032,["value","onUpdate:value","options","show-arrow","disabled","onChange"])]),y.isWorkspaceEdit?p("",!0):(a(),r("div",vt,[(a(!0),r(V,null,N(t(A),(l,j)=>(a(),r("div",{key:j,class:"flex flex-wrap items-center security-corp cursor-pointer",onClick:h=>ae(u,j)},[t($)[u]&&l.isSelectMenuOpen?(a(),T(J,{key:0,visible:l.isSelectMenuOpen,"onUpdate:visible":h=>l.isSelectMenuOpen=h,"overlay-class-name":"w-[220px]",trigger:"click",placement:"bottomLeft","destroy-tooltip-on-hide":"",onVisibleChange:h=>ue(u,j)},{content:S(()=>[c(be,{"referenced-dimension-id":l.referencedDimensionId,content:o.dimensionContentAttributesView[L(l)],"security-id":l.id,"member-internal-id":o.internalId,onUpdateContent:h=>ve(o.dimensionContentAttributesView,L(l),h)},null,8,["referenced-dimension-id","content","security-id","member-internal-id","onUpdateContent"])]),_:2},1032,["visible","onUpdate:visible","onVisibleChange"])):p("",!0),s("div",ft,[c(w,{color:"#5D6585",path:t(De),type:"mdi"},null,8,["path"])]),s("div",null,[(a(!0),r(V,null,N(o.dimensionContentAttributesView[L(l)],(h,Ie)=>(a(),r("div",{key:Ie,class:"blue-ship-security-content text-blue-250 font-medium text-xs items-center"},[s("div",yt,f(h.name),1)]))),128))])],8,_t))),128))])),s("div",bt,[`${o.dimensionContentAttributesView[t(m)]}`!="Owner"?(a(),T(w,{key:0,color:"#5D6585",path:t(Q),type:"mdi",size:"22px",class:"pb-1 cursor-pointer",onClick:l=>pe(o.dimensionContentAttributesView[t(P)],u)},null,8,["path","onClick"])):p("",!0)])])],2))),128))])]),_:1}),c(X,{visible:t(k),"onUpdate:visible":n[1]||(n[1]=o=>Z(k)?k.value=o:null),"destroy-on-close":"",width:"400px",footer:null},{default:S(()=>[c(Ce,{"security-corp-name":t(W).name,security:t(W),onCloseDelete:n[0]||(n[0]=o=>k.value=!1)},null,8,["security-corp-name","security"])]),_:1},8,["visible"]),c(X,{visible:t(C),"onUpdate:visible":n[3]||(n[3]=o=>Z(C)?C.value=o:null),"destroy-on-close":"",footer:null,width:"560px"},{default:S(()=>[c(xe,{"delete-security-ref":t(F),onDelete:me,onCloseDelete:n[2]||(n[2]=o=>C.value=!1)},null,8,["delete-security-ref"])]),_:1},8,["visible"])],64)}}}),$t=Re(ht,[["__scopeId","data-v-8a60a358"]]);export{$t as default};
