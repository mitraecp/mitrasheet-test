import{f as ee,aY as te,aX as ae,al as g,r as v,Y as oe,H as se,a3 as ne,u as t,N as ie,O as le,b as S,l as i,w as d,e as o,c as w,by as re,ax as N,J as f,v as _,o as p,dT as de,t as pe,ah as me,m as ce,y as ue,z as ve,x as fe,a as _e}from"./entry.102678be.js";import ye from"./BaseContentHeader.0262d7f9.js";import{_ as De}from"./MButton.vue.eb72e6c7.js";/* empty css                    */import{u as ge,_ as we,a as xe}from"./DatasetEditor.vue.7d311014.js";import{_ as be}from"./DimensionList.vue.eb7d2f91.js";import{_ as Se}from"./DatasetList.vue.42e42433.js";import{u as ke}from"./dimension_store.1aca34b5.js";import{a as he}from"./useGoToScreen.2d5a4740.js";import{r as Ce}from"./useFormRules.a113b67d.js";import{u as Be}from"./dataset_store.f318df7c.js";import"./MitraIconButton.142ef623.js";import"./AccordionListMenu.10ceb037.js";import"./drag.f5ca2003.js";import"./useDataTypeIcons.d26d6eae.js";import"./useLegacyService.c9b3bbf8.js";import"./legacy_store.afec42ea.js";import"./useHeadSettings.f1985dcc.js";import"./composables.aec528df.js";import"./useURLPaths.92126496.js";const Te=""+new URL("cube_overlay.307f9edb.svg",import.meta.url).href,y=m=>(ue("data-v-34fa3965"),m=m(),ve(),m),Ne={key:0,class:"flex flex-col sidebar-right min-w-[280px] max-w-[260px] noselect"},Ee={class:"h-full p-4 overflow-auto"},Ie=y(()=>o("span",{class:"text-sm text-grey-700 font-medium hidden"},"Internos",-1)),Ve={class:"px-5 py-1 hidden"},$e={class:"flex justify-between items-center"},Ae={key:0},Me=y(()=>o("img",{class:"w-[20px]",src:xe},null,-1)),Ue=y(()=>o("span",{class:"ml-2"},"Dimens\xE3o",-1)),Fe=[Me,Ue],Le=y(()=>o("img",{class:"w-[20px] h-[15px]",src:Te},null,-1)),je=y(()=>o("span",{class:"ml-2"},"Dataset",-1)),ze=[Le,je],Re={key:1},He={class:"flex flex-col justify-between"},Oe=ee({__name:"MetadataMenu",props:{tableType:{type:String,default:"view"},loadingSheet:{type:Boolean,default:!1}},emits:["selected-data","update-view","in-dragging","load-sheet","close-drawer"],setup(m,{emit:n}){const E=te(),I=ae(),{getDataViewMode:V,preview:$}=g(E),{menuDatabase:A}=g(I),s=v({active:!1,type:""}),M=oe(),x=ke(),U=Be(),b=v(!1),c=v(!1),r=v(),l=v(!1),{dimensionForm:D,resetForm:k}=ge().dimensionCreator(),F=se(()=>s.value.type==="dataset"?"Novo Dataset":"Nova Dimens\xE3o");ne(l,u=>{u||(s.value={active:!1,type:""},k())});const{treeDatasets:h}=g(U),{treeDimensions:L}=g(x),j=async()=>{b.value=!0;try{await x.addDimension(D.value.name.trim()),k(),l.value=!1}catch{}b.value=!1};function z(){n("close-drawer")}function R(u){r.value&&(r.value.name=u.name,n("update-view",{isDataset:r.value.isDataset,id:r.value.id,name:r.value.name})),c.value=!1}function H(){x.fetchDimensions(),n("selected-data")}function O(){n("selected-data")}function Y(){he(void 0,{newTab:!0})}return(u,e)=>{var T;const C=fe,q=ye,G=_("a-input"),J=_("a-form-item"),P=De,W=_("a-form"),B=we,X=_("a-popover"),K=be,Q=Se,Z=_("a-modal");return t(A)?ie((p(),S("aside",Ne,[i(q,{"box-class":"p-4 light-border-b",title:"Database",onCancel:z},{suffix:d(()=>[i(C,{class:"ml-2 mt-[1px] cursor-pointer",color:"var(--grey-500)",type:"mdi",size:"16",path:t(de),onClick:Y},null,8,["path"])]),_:1}),o("div",Ee,[Ie,o("div",Ve,[t(M).readonlyProject?f("",!0):(p(),w(X,{key:0,visible:t(l),"onUpdate:visible":e[5]||(e[5]=a=>N(l)?l.value=a:null),"overlay-class-name":t(s).type==="dataset"?"w-[350px]":"w-[200px]",trigger:"click",placement:"topLeft","arrow-point-at-center":"","destroy-popup-on-hide":""},re({content:d(()=>[t(s).active?(p(),S("div",Re,[t(s).type==="dimension"?(p(),w(W,{key:0,model:t(D),name:"form-new-dimension",autocomplete:"off",onFinish:j},{default:d(()=>[i(J,{class:"my-0",name:"name",rules:[t(Ce)]},{default:d(()=>[i(G,{value:t(D).name,"onUpdate:value":e[3]||(e[3]=a=>t(D).name=a),class:"rounded-md mb-2",placeholder:"Nome","data-cy":"input-name"},null,8,["value"])]),_:1},8,["rules"]),i(P,{loading:t(b),"html-type":"submit","data-cy":"btn-submit"},{default:d(()=>[ce(" Criar")]),_:1},8,["loading"])]),_:1},8,["model"])):f("",!0),t(s).type==="dataset"?(p(),w(B,{key:1,onSaved:e[4]||(e[4]=a=>{l.value=!1,s.value={type:"",active:!1}})})):f("",!0)])):(p(),S("div",Ae,[o("div",{class:"flex items-center cursor-pointer mb-2",onClick:e[1]||(e[1]=a=>s.value={active:!0,type:"dimension"})},Fe),o("div",{class:"flex items-center cursor-pointer",onClick:e[2]||(e[2]=a=>s.value={active:!0,type:"dataset"})},ze)]))]),_:2},[t(s).active?{name:"title",fn:d(()=>[o("div",$e,[o("span",null,pe(t(F)),1),i(C,{class:"cursor-pointer",size:"15",color:"grey",type:"mdi",path:t(me),onClick:e[0]||(e[0]=a=>l.value=!1)},null,8,["path"])])]),key:"0"}:void 0]),1032,["visible","overlay-class-name"]))]),o("div",He,[i(K,{class:"metadata-wrapper",dimensions:t(L),onActivated:e[6]||(e[6]=a=>n("selected-data",a)),onUpdated:e[7]||(e[7]=a=>n("update-view",a)),onDeleted:H,onInDragging:e[8]||(e[8]=a=>n("in-dragging",a))},null,8,["dimensions"]),(T=t(h))!=null&&T.length?(p(),w(Q,{key:0,class:"metadata-wrapper",datasets:t(h),"table-type":m.tableType,onEditData:e[9]||(e[9]=a=>{l.value=!1,c.value=!0,r.value=a}),onActivated:e[10]||(e[10]=a=>n("selected-data",a)),onDeleted:O,onInDragging:e[11]||(e[11]=a=>n("in-dragging",a))},null,8,["datasets","table-type"])):f("",!0)])]),i(Z,{visible:t(c),"onUpdate:visible":e[12]||(e[12]=a=>N(c)?c.value=a:null),"data-cy":"edit-attribute-modal","destroy-on-close":"",title:"Editar Dataset",footer:!1,"body-style":{padding:0}},{default:d(()=>[i(B,{"modal-child":"",editor:"","selected-dataset":t(r),onSaved:R},null,8,["selected-dataset"])]),_:1},8,["visible"])],512)),[[le,!t($)||t(V)==="DATABASE"]]):f("",!0)}}}),pt=_e(Oe,[["__scopeId","data-v-34fa3965"]]);export{pt as default};
