import{f as H,ae as W,aX as Y,al as N,r as p,a3 as Z,v as J,o as i,b as k,u as o,l,dU as P,e as s,t as z,J as $,k as X,M as j,c as f,w as d,aV as q,aw as G,ay as K,ax as Q,x as tt,dL as et,a as ot}from"./entry.102678be.js";import nt from"./SpreadSheetEditDynamization.5561326d.js";import at from"./SpreadSheetDynamization.873b495d.js";import it from"./MitraButton.1bc6f00c.js";import"./ProjectView.vue.c9650a78.js";import"./useURLPaths.92126496.js";import"./BaseContentHeader.0262d7f9.js";import"./MitraIconButton.142ef623.js";import"./BaseContentFooter.vue.20fdc5e7.js";import"./dimension_store.1aca34b5.js";import"./useLegacyService.c9b3bbf8.js";/* empty css                         *//* empty css                    *//* empty css                             */import"./legacy_store.afec42ea.js";import"./useHeadSettings.f1985dcc.js";import"./composables.aec528df.js";import"./HeaderBar.vue.02da9777.js";import"./members_store.a95d955a.js";import"./dataset_store.f318df7c.js";import"./metadata_store.49c5a48c.js";/* empty css                                    *//* empty css                           */import"./useChartsSettings.971a22bb.js";/* empty css                         *//* empty css                            *//* empty css                             */import"./regexp.6086e722.js";/* empty css                        *//* empty css                        */const st={class:"flex items-center overflow-hidden"},rt=["title"],lt={class:"overflow-hidden"},mt={class:"flex overflow-auto"},pt=["title","onClick"],dt={class:"truncate"},ct={class:"text-grey-900 font-medium"},ut={class:"text-grey-900 font-medium"},_t=H({__name:"SpreadSheetDynamicMenu",props:{readonly:{type:Boolean,default:!1}},emits:["update"],setup(T,{emit:b}){const{saveDynamization:B}=et(),y=W(),h=Y(),{activeDynamizations:M,activeSheetRef:w}=N(y),{dynamizationController:c}=N(h),m=p(!1),U=p(!1),u=p({}),_=p(0),S=p("");Z(()=>c.value,e=>{e||(S.value="")});function V(){h.switchDialog("dynamizationController"),S.value=""}async function D({list:e,dimension:r}){if(w.value.workbookId===0)throw new Error("WorkbookId n\xE3o encontrado");const{data:n,error:x}=await B({workbookId:w.value.workbookId,filterItemForm:{dimensionId:r.id||0,internalIds:e.map(v=>v.internalId)}});if(x)throw new Error("Falha ao atualizar dinamiza\xE7\xE3o");n.dynamization.contents=[n.dynamization.contents[0]],y.updateDynamizations(n.dynamization),b("update"),h.switchDialog("dynamizationController"),m.value=!0}function A(e){u.value&&(u.value.contents=[e],y.updateDynamizations(u.value),b("update"),U.value=!1)}function F(e){m.value=!0,u.value=e}function L(){m.value=!1}return(e,r)=>{const n=tt,x=nt,v=at,g=J("a-popover"),O=it;return i(),k("div",st,[o(_)?(i(),k("div",{key:0,class:"ml-2 chip",title:`${o(_)} filtro${o(_)&&"s"}`},[l(n,{size:"20",color:"grey",type:"mdi",path:o(P)},null,8,["path"]),s("div",lt,[s("span",null,z(o(_)),1)])],8,rt)):$("",!0),s("div",mt,[(i(!0),k(X,null,j(o(M),(t,R)=>(i(),f(g,{key:R,visible:t.open,"onUpdate:visible":a=>t.open=a,placement:"bottomLeft",trigger:"click","arrow-point-at-left":""},{content:d(()=>[o(m)?(i(),f(x,{key:0,item:t,onSelect:a=>(A(a),t.open=!1),onEdit:L},null,8,["item","onSelect"])):(i(),f(v,{key:1,chip:"menu","title-text":e.$t("SHEET.DYNAMIZATION.edit_dynamization"),edit:!0,dimension:{id:t.dimensionId,name:t.dimensionName},onCancel:r[0]||(r[0]=a=>m.value=!0),onSubmit:D},null,8,["title-text","dimension"]))]),default:d(()=>{var a,I,C,E;return[s("div",{class:"chip medium-border-all",title:`${t.dimensionName}: ${(I=(a=t.contents)==null?void 0:a[0])==null?void 0:I.name}`,onClick:vt=>F(t)},[l(n,{size:"15",color:"var(--grey-500)",type:"mdi",class:"mr-[7px]",path:o(q)},null,8,["path"]),s("div",dt,[s("span",ct,z(t.dimensionName)+": ",1),s("span",ut,z((E=(C=t.contents)==null?void 0:C[0])==null?void 0:E.name),1)]),l(n,{class:"ml-[9px]",size:"20",color:"var(--grey-500)",type:"mdi",path:o(G)},null,8,["path"])],8,pt)]}),_:2},1032,["visible","onUpdate:visible"]))),128))]),l(g,{visible:o(c),"onUpdate:visible":r[1]||(r[1]=t=>Q(c)?c.value=t:null),"destroy-popup-on-hide":"",placement:"bottomLeft","overlay-class-name":"sheet-popover",trigger:"click","arrow-point-at-left":""},{content:d(()=>[l(v,{chip:"menu","title-text":e.$t("SHEET.DYNAMIZATION.create_dynamization"),edit:!1,dimension:void 0,onCancel:V,onSubmit:D},null,8,["title-text"])]),default:d(()=>[T.readonly?$("",!0):(i(),f(O,{key:0,text:e.$t("BUTTONS.add"),"text-color":"var(--grey-500)","type-text":""},{preffix:d(()=>[l(n,{class:"mr-1",size:"14px",type:"mdi",color:"var(--grey-500)",path:o(K)},null,8,["path"])]),_:1},8,["text"]))]),_:1},8,["visible"])])}}}),Jt=ot(_t,[["__scopeId","data-v-890d4b62"]]);export{Jt as default};
