import{ab as x,eo as He,f as Ge,aX as Q,ae as Ve,aY as ze,al as w,r as v,S as Je,Y as be,H as C,a3 as qe,v as O,aF as Ye,o as a,b as c,e as l,u as e,t as m,J as _,C as P,N as ye,c as g,ax as u,w as i,l as n,ar as ge,aw as Ke,ex as Qe,k as Xe,R as X,s as B,Q as Ze,x as et,y as tt,z as ot,a as st}from"./entry.102678be.js";import{_ as nt}from"./ExpandsMenu.vue.3757509f.js";import lt from"./PreviewStateButton.04f09afe.js";import{_ as at}from"./CollaboratorAvatar.vue.dd08577c.js";import rt from"./LoggedUserSettings.3ca3ab1b.js";import it from"./AddScreenLegacy.ec1b98d8.js";import ct from"./InvitationPanel.3b635fcd.js";import ut from"./MitraButton.1bc6f00c.js";import dt from"./ImportedFile.624ad7d8.js";import{_ as pt}from"./NewFolderPanel.vue.29aeb603.js";import"./HeaderBar.vue.02da9777.js";import mt from"./NewMobilePanel.7dd23633.js";import ft from"./DeleteFolderPanel.a63213f6.js";import vt from"./DeleteWorkspacePanel.397d2c37.js";import{u as _t}from"./legacy_store.afec42ea.js";import{u as bt}from"./members_store.a95d955a.js";import{u as yt}from"./useHeadSettings.f1985dcc.js";import{e as xe,b as gt}from"./useGoToScreen.2d5a4740.js";import{_ as xt}from"./brand_logo.4b36a3ff.js";import ht from"./GlobalScreenSearch.11da1226.js";import"./UserInfo.vue.9a89b8e2.js";import"./LanguageSettings.087eeb24.js";import"./SquaredBadge.8fadbfe8.js";import"./useMappedIcons.1032e4dc.js";/* empty css                         */import"./useSpaceHelpers.ee842422.js";import"./useURLPaths.92126496.js";import"./layout_violet.70afa0aa.js";import"./folder_open_black.966f6325.js";import"./SpaceCollaborator.9a7c5525.js";import"./phone_violet.fde2a48f.js";import"./useLegacyService.c9b3bbf8.js";import"./dimension_store.1aca34b5.js";import"./composables.aec528df.js";import"./PrefixWidgetsGlobalSearch.c07251fa.js";import"./simple_grid_purple.8fc55868.js";import"./dataset_store.f318df7c.js";import"./metadata_store.49c5a48c.js";import"./index.d52a6416.js";import"./index.3105222b.js";function he(){const{path:b,name:$}=x(),h=b.includes("database"),F=b.includes("sheet"),E=$===He.WORKSPACE_SETTINGS;return{insideDatabase:h,insideSheet:F,insideWorkspaceSettings:E}}const St=""+new URL("logo_vertical.7af86179.svg",import.meta.url).href,kt=b=>(tt("data-v-4bd2ae56"),b=b(),ot(),b),wt={class:"flex items-center basis-1/3"},Ct={key:2,class:"ml-[18px] h-[44px] flex flex-col max-w-[80%] justify-center"},Pt={key:0,class:"text-grey-600 truncate"},Et={class:"flex items-center"},Tt={key:3,class:"ml-[18px] h-[44px] flex flex-col max-w-[80%] justify-center"},Rt={class:"text-grey-600 truncate"},Ut=kt(()=>l("div",{class:"flex items-center"},[l("h5",{class:"text-grey-900 font-medium truncate"},"Database")],-1)),At={key:4,class:"ml-[18px] h-[44px] flex flex-col max-w-[80%] justify-center"},Dt={class:"text-grey-600 truncate"},jt={class:"flex items-center"},It={class:"text-grey-900 font-medium truncate"},Mt={key:5,class:"ml-[18px] h-[44px] flex flex-col max-w-[80%] justify-center"},Ot={key:0,class:"text-grey-600 truncate"},Bt={class:"flex items-center"},$t={class:"flex items-center basis-1/3 justify-end"},Ft={class:"w-[221px]"},Nt={class:"flex flex-col justify-center items-center py-4 mr-4"},Lt={class:"bg-grey-100 rounded-3xl h-[32px] w-[32px] flex items-center justify-center"},Wt={class:"cursor-default text-grey-500 font-normal text-sm"},Ht={class:"flex justify-center items-center mr-6"},Gt={class:"flex items-center"},Vt=Ge({__name:"HeaderBar",setup(b){const $=Q(),h=Ve(),F=ze(),E=_t(),S=bt(),{selectedModule:T,getSelectedScreen:R,selectedScreenId:Z}=w(E),U=v(""),ee=v(),A=v(),{invitationPanelController:N,uploadFileController:L,addScreenController:D,newFolderModelController:W,newMobileModelController:H,userSettingsController:G,deleteFolderPanelController:V,deleteWorkspacePanelController:j}=w($),{loggedUser:te}=w(Je()),{selectedProject:k,readonlyProject:z}=w(be()),{isPreview:Se}=w(F),{activeSheetRef:I}=w(h),ke=yt(),d=v([]),p=v(!1),r=v(""),J=v(!1),f=v(!1),M=C(()=>x().path.includes(X.SHEET)),oe=C(()=>x().path.includes(X.DATABASE)),se=C(()=>{var o;return(o=ee.value)==null?void 0:o.nativeScreens.children.find(t=>t.id===Z.value)}),q=C(()=>x().path.includes(`/${X.MODULE_SHORTCUT}`)),Y=C(()=>z.value||Se.value);function we(o){U.value=o}function ne(){const{insideWorkspaceSettings:o}=he();if(o){be().setEmptyProject(),xe(void 0,void 0,{withoutProject:!0});return}xe()}const Ce=o=>{if(J.value=!0,o.file.status!=="uploading"&&o.fileList.length>0){const t=o.fileList[0];A.value=t.originFileObj,J.value=!1}};function le(o){Y.value||(o==="sheet"&&(r.value=I.value.name),o==="merge"&&R.value&&(r.value=R.value.name),p.value=!0)}async function Pe(){if(!r.value||r.value===I.value.name){p.value=!1;return}try{await h.renameWorkbook({workbookId:I.value.workbookId,name:r.value}),h.updateActiveSheetRef({name:r.value}),p.value=!1}catch{B("TOAST.fail_to_rename_worksheet")}}async function Ee(){var o,t;if(!r.value||r.value===((o=R.value)==null?void 0:o.name)){p.value=!1;return}try{await E.editScreenName({id:Z.value,name:r.value,moduleId:(t=T==null?void 0:T.value)==null?void 0:t.id}),p.value=!1}catch{B("TOAST.fail_to_rename_screen")}}async function ae(){if(!A.value)throw B("TOAST.file_not_found"),new Error("File not found");f.value=!0;try{const o=await h.uploadSheet({file:A.value,projectId:k.value.id});Q().switchDialog("uploadFileController"),Te(o.workbookId)}catch{B("TOAST.fail_to_upload_file")}re()}function Te(o){const{insideSheet:t}=he();t?Ze().replace({params:{...x().params,sheetId:o},query:{...x().query,tab:0}}):gt(o)}qe(()=>x().path,o=>{ke.getNewTitleByPath(o),U.value&&(U.value="")});function re(){f.value=!1,A.value=void 0,d.value=[]}function Re(o){S.membersDimensionContent&&(S.fetchData(S.isWorkspace),S.setActiveProjectMembers(o.collaborators),S.setActiveProjectOpenInvitations(o.openInvitations))}return(o,t)=>{var de,pe,me,fe,ve;const K=O("a-input"),ie=et,Ue=nt,ce=O("a-dropdown"),Ae=lt,De=at,je=rt,Ie=it,y=O("a-modal"),Me=ct,Oe=O("a-upload"),Be=ut,$e=dt,Fe=pt,Ne=mt,Le=ft,We=vt,ue=Ye("focus");return a(),c(Xe,null,[l("div",{class:P(["navbar",{"!bg-grey-25":e(M),hidden:o.$withoutHeader()}])},[l("div",wt,[e(M)||e(q)||e(oe)?(a(),c("img",{key:0,class:"cursor-pointer",src:xt,height:"32",width:"32",alt:"mitra_logo",onClick:ne})):(a(),c("img",{key:1,class:"cursor-pointer",src:St,width:"99",height:"32",alt:"mitra_logo",onClick:ne})),e(M)?(a(),c("div",Ct,[e(p)?_("",!0):(a(),c("span",Pt,m(e(k).name),1)),l("div",Et,[e(p)?ye((a(),g(K,{key:1,ref:"input",value:e(r),"onUpdate:value":t[1]||(t[1]=s=>u(r)?r.value=s:null),"data-cy":"input-name",class:"mr-4 input-rename",onBlur:Pe,onPressEnter:t[2]||(t[2]=s=>s.target.blur())},null,8,["value"])),[[ue]]):(a(),c("h5",{key:0,class:P(["text-grey-900 font-medium truncate",{"cursor-pointer":!e(Y)}]),onClick:t[0]||(t[0]=s=>le("sheet"))},m(e(I).name),3)),e(z)?_("",!0):(a(),g(ce,{key:2,trigger:"hover","destroy-popup-on-hide":"","overlay-class-name":"formatter-menu"},{overlay:i(()=>[n(Ue)]),default:i(()=>[l("div",{class:"icon-button icon-more",onClick:t[3]||(t[3]=ge(()=>{},["stop"]))},[n(ie,{size:"18px",type:"mdi",class:"ml-2.5 hidden",color:"var(--grey-900)",path:e(Ke)},null,8,["path"])])]),_:1}))])])):e(oe)?(a(),c("div",Tt,[l("span",Rt,m(e(k).name),1),Ut])):((de=e(se))==null?void 0:de.id)&&e(q)?(a(),c("div",At,[l("span",Dt,m((pe=e(k))==null?void 0:pe.name),1),l("div",jt,[l("h5",It,m((me=e(se))==null?void 0:me.name),1)])])):e(q)?(a(),c("div",Mt,[e(p)?_("",!0):(a(),c("span",Ot,m((fe=e(T))==null?void 0:fe.name),1)),l("div",Bt,[e(p)?ye((a(),g(K,{key:1,ref:"input",value:e(r),"onUpdate:value":t[5]||(t[5]=s=>u(r)?r.value=s:null),class:"mr-4 input-rename",onBlur:Ee,onPressEnter:t[6]||(t[6]=s=>s.target.blur())},null,8,["value"])),[[ue]]):(a(),c("h5",{key:0,class:P(["text-grey-900 font-medium truncate",{"cursor-pointer":!e(Y)}]),onClick:t[4]||(t[4]=s=>le("merge"))},m((ve=e(R))==null?void 0:ve.name),3))])])):_("",!0)]),e(k).id?(a(),g(ht,{key:0,ref_key:"globalSearchRef",ref:ee,class:"basis-1/3 flex items-center justify-center","search-value":e(U),"user-access":e(k).accessType,onUpdateSearchValue:we},null,8,["search-value","user-access"])):_("",!0),l("div",$t,[e(M)&&!e(z)?(a(),g(Ae,{key:0})):_("",!0),n(ce,{visible:e(G),"onUpdate:visible":t[9]||(t[9]=s=>u(G)?G.value=s:null),trigger:"click","destroy-popup-on-hide":"",placement:"bottomLeft","overlay-class-name":"p-[18px] mitra-popover-wrapper medium-border-all"},{overlay:i(()=>[l("div",Ft,[n(je,{onClosePopup:t[8]||(t[8]=s=>e(Q)().switchDialog("userSettingsController"))})])]),default:i(()=>{var s,_e;return[l("div",{class:"icon-button icon-more",onClick:t[7]||(t[7]=ge(()=>{},["stop"]))},[(s=e(te))!=null&&s.id?(a(),g(De,{key:0,class:"cursor-pointer mx-2",src:(_e=e(te))==null?void 0:_e.picture,width:36,height:36},null,8,["src"])):_("",!0)])]}),_:1},8,["visible"])])],2),n(y,{visible:e(D),"onUpdate:visible":t[10]||(t[10]=s=>u(D)?D.value=s:null),"destroy-on-close":"",width:"400px",footer:null,"wrap-class-name":"add-screen"},{default:i(()=>[e(D)?(a(),g(Ie,{key:0})):_("",!0)]),_:1},8,["visible"]),n(y,{visible:e(N),"onUpdate:visible":t[12]||(t[12]=s=>u(N)?N.value=s:null),title:e(S).isWorkspace?o.$t("MEMBERS.invite_workspace_members"):o.$t("MEMBERS.invite_members"),"destroy-on-close":"",width:"662px",footer:null},{default:i(()=>[n(Me,{onReloadMembersAccess:t[11]||(t[11]=s=>Re(s))})]),_:1},8,["visible","title"]),n(y,{visible:e(L),"onUpdate:visible":t[14]||(t[14]=s=>u(L)?L.value=s:null),"destroy-on-close":"",centered:"","mask-closable":!e(f),title:o.$t("PROJECT.import_file"),class:"import-file","ok-button-props":{loading:e(f),disabled:e(d).length===0||e(f)},"cancel-button-props":{disabled:e(f)||e(J)},"ok-text":"Importar dados","cancel-text":"Cancelar",onCancel:re,onOk:ae},{footer:i(()=>[l("div",Ht,[l("div",Gt,[n(Be,{loading:e(f),disabled:e(d).length===0||e(f),class:"mt-2.5",text:o.$t("GLOBAL.start"),color:"var(--violet-600)","fit-to-content":"",onClick:ae},null,8,["loading","disabled","text"])])])]),default:i(()=>[n(Oe,{"file-list":e(d),"onUpdate:fileList":t[13]||(t[13]=s=>u(d)?d.value=s:null),"list-type":"picture",class:P(["flex justify-center items-center import-upload",{"!bg-grey-50":e(d).length}]),accept:".csv,.xlsx,.xlsm",onChange:Ce},{default:i(()=>[l("div",Nt,[l("div",Lt,[n(ie,{size:"18px",type:"mdi",color:"var(--grey-600)",path:e(Qe)},null,8,["path"])]),l("div",{class:P(["cursor-pointer upload-click-text pt-3",{"!text-grey-300":e(d).length}])},m(o.$t("PROJECT.click_to_select")),3),l("div",Wt,m(o.$t("PROJECT.or_drag_and_drop")),1)])]),_:1},8,["file-list","class"]),n($e,{"file-list":e(d)},null,8,["file-list"])]),_:1},8,["visible","mask-closable","title","ok-button-props","cancel-button-props"]),n(y,{visible:e(W),"onUpdate:visible":t[15]||(t[15]=s=>u(W)?W.value=s:null),"destroy-on-close":"",width:"400px",footer:null},{default:i(()=>[n(Fe)]),_:1},8,["visible"]),n(y,{visible:e(H),"onUpdate:visible":t[16]||(t[16]=s=>u(H)?H.value=s:null),"destroy-on-close":"",width:"400px",footer:null},{default:i(()=>[n(Ne)]),_:1},8,["visible"]),n(y,{visible:e(V),"onUpdate:visible":t[17]||(t[17]=s=>u(V)?V.value=s:null),"destroy-on-close":"",width:"400px",footer:null},{default:i(()=>[n(Le)]),_:1},8,["visible"]),n(y,{visible:e(j),"onUpdate:visible":t[19]||(t[19]=s=>u(j)?j.value=s:null),"destroy-on-close":"",footer:null,width:"560px"},{default:i(()=>[n(We,{onCloseDelete:t[18]||(t[18]=s=>j.value=!1)})]),_:1},8,["visible"])],64)}}}),jo=st(Vt,[["__scopeId","data-v-4bd2ae56"]]);export{jo as default};
