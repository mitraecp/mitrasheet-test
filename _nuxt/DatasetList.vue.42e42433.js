import{f as E,r as D,H as $,v as j,o as l,c as g,w as d,e as a,l as w,u as t,aq as M,t as v,ax as R,C,J as q,aK as F,ap as G,b as f,M as H,k as I,x as J}from"./entry.102678be.js";import K from"./AccordionListMenu.10ceb037.js";import{u as U,_ as N}from"./drag.f5ca2003.js";import{u as P}from"./useDataTypeIcons.d26d6eae.js";import{u as Q}from"./dataset_store.f318df7c.js";import{a as W}from"./useGoToScreen.2d5a4740.js";const X=["onDblclick"],Y={class:"flex items-center"},Z=["title"],O=["onClick"],ee=a("span",null,"Editar dataset",-1),te=[ee],se=["onClick"],ne=a("span",null,"Deletar",-1),ae=[ne],oe=["onDragstart","onDblclick"],ie={class:"flex items-center"},le=["title"],re=["title"],ce=a("img",{height:"13.13",src:N},null,-1),de=["onDragstart"],me={class:"flex items-center"},pe=["title"],ue=a("img",{height:"13.13",src:N},null,-1),De=E({__name:"DatasetList",props:{datasets:{type:Array,default:()=>[]},tableType:{type:String,default:"view"}},emits:["activated","edit-data","deleted","in-dragging"],setup(b,{emit:m}){const S=b,{handleDragEnd:p,handleDragStart:x,handleDragging:h}=U(),T=P(),c=D(!1),u=D(!1),y=D(),L=$(()=>S.datasets.map(i=>(i.datasetContent=[...i.datasetDimensionViews,...i.metricViews],i)));function V(i){c.value=!1,y.value=void 0,m("edit-data",{...i})}async function z(i){if(!u.value){u.value=!0;try{await Q().removeDataset(i),m("deleted")}catch{}u.value=!1}}function k(i){W(`?openDataset=${i}`,{newTab:!0})}return(i,s)=>{const _=J,B=j("a-popover"),A=K;return l(),g(A,{options:t(L),"content-keys":{children:"datasetContent",subChildren:"dimensionAttributeViewList",type:"dataType",childrenName:"dimensionName",id:"id"},onContextSelect:s[5]||(s[5]=e=>{c.value=!0,y.value=e}),onSelected:s[6]||(s[6]=e=>m("activated",e))},{content:d(({item:e})=>[a("div",{class:"flex items-center justify-between w-full tile tile--static",draggable:!1,onDblclick:o=>k(e.id)},[a("div",Y,[w(_,{class:"mr-2.5",color:"var(--grey-700)",path:t(M),type:"mdi",size:"20px"},null,8,["path"]),a("span",{class:"content-name max-w-[165px] truncate",title:e.name},v(e.name),9,Z)])],40,X)]),popup:d(({item:e})=>{var o;return[((o=t(y))==null?void 0:o.id)===e.id?(l(),g(B,{key:0,visible:t(c),"onUpdate:visible":s[0]||(s[0]=n=>R(c)?c.value=n:null),trigger:"click"},{content:d(()=>[a("div",{class:"select-tile",onClick:n=>V(e)},te,8,O),a("div",{class:C(["select-tile",{"cursor-wait":t(u)}]),onClick:n=>z(e.id)},ae,10,se)]),_:2},1032,["visible"])):q("",!0)]}),childrenContent:d(({item:e})=>{var o,n;return[a("div",{class:C(["flex items-center justify-between w-full tile",{"!ml-0":"metricName"in e}]),draggable:!0,onDragstart:r=>t(x)(r,e),onDrag:s[1]||(s[1]=(...r)=>t(h)&&t(h)(...r)),onDragend:s[2]||(s[2]=(...r)=>t(p)&&t(p)(...r)),onDblclick:r=>k(e.id)},[a("div",ie,["metricName"in e?(l(),g(_,{key:0,class:"mr-2.5",color:"var(--grey-500)",path:t(F),type:"mdi",size:"18px"},null,8,["path"])):(l(),g(_,{key:1,class:"mr-2.5",color:"var(--grey-500)",path:t(G),type:"mdi",size:"20px"},null,8,["path"])),"metricName"in e?(l(),f("span",{key:2,class:"content-name max-w-[135px] truncate",title:e.metricName},v(e.metricName),9,le)):(l(),f("span",{key:3,class:"content-name w-[135px] truncate",title:(o=e.alias)!=null?o:e.dimensionName},v((n=e.alias)!=null?n:e.dimensionName),9,re))]),ce],42,oe)]}),children:d(({values:e})=>[(l(!0),f(I,null,H(e,o=>(l(),f("div",{key:o.id,class:"flex items-center justify-between w-full tile",draggable:!0,onDragstart:n=>t(x)(n,o),onDragend:s[3]||(s[3]=(...n)=>t(p)&&t(p)(...n)),onDrag:s[4]||(s[4]=n=>{t(h)(n),m("in-dragging",n)})},[a("div",me,[w(_,{class:"mr-2.5",color:"var(--grey-500)",path:t(T)[o.dimensionAttributeType],type:"mdi",size:"14"},null,8,["path"]),a("span",{title:o.name,class:"children-name children-name--sub"},v(o.name),9,pe)]),ue],40,de))),128))]),_:1},8,["options"])}}});export{De as _};
